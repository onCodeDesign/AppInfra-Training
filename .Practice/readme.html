<head class="selectNone"><style type="text/css" id="pluginCss">:root {
  --plugin-contextmenu-icon-checkbox: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACqSURBVDhPpZO9EcMgDEY/MoTmwQtQQWpnnLiOlwhULGDmUcsATuEUiQ7zc36ldPeeClA55x0XUDnn3Rgj513EGHGTw1H+LgjBy30Rax0wcgEzw1qH9bXKVZ/Av4/L3P0o/9IUMDO2lDBpDSKS67agVkdJsDwXWOvAzM06SoL5MQPfcquOkoCIMGmNLaVmHSUBRLFWx5mAiBCCRwi+Wod8iaN0v8Qa6up3/gC0W09UEJtfPwAAAABJRU5ErkJggg==);
  --plugin-default-grayscale-bias-opacity: 0.25;
  --plugin-font-family: "Segoe UI";
  --plugin-font-size: 9pt;
  --plugin-font-weight: normal;
  --plugin-color: #000000E4;
  --plugin-contextmenu-active-color: #F3F3F3C2;
  --plugin-contextmenu-background-color: #F3F3F3FF;
  --plugin-contextmenu-border-color: #0000000F;
  --plugin-contextmenu-color: #000000E4;
  --plugin-contextmenu-hover-color: #0000000F;
  --plugin-contextmenu-hover-text-color: #000000E4;
  --plugin-contextmenu-hover-border-color: #0000000F;
  --plugin-contextmenu-inactive-text-color: #0000005C;
  --plugin-contextmenu-separator-color: #00000014;
  --plugin-background-color: #F3F3F3FF;
  --plugin-error-border-color: #C42B1CFF;
  --plugin-inactive-color: #0000005C;
  --plugin-link-color: #003E92FF;
  --plugin-link-hover-color: #001A68FF;
  --plugin-link-active-color: #001A68FF;
  --plugin-table-header-color: #000000E4;
  --plugin-table-header-background-color: #EEEEEEFF;
  --plugin-table-border-color: #00000014;
  --plugin-highlight-color: #FFFFFFFF;
  --plugin-highlight-background-color: #5649B0FF;
  --plugin-scrollbar-arrow-background-color: #FFFFFFB2;
  --plugin-scrollbar-arrow-background-active-color: #F9F9F980;
  --plugin-scrollbar-arrow-background-hover-color: #F9F9F980;
  --plugin-scrollbar-arrow-color: #00000072;
  --plugin-scrollbar-arrow-active-color: #00000072;
  --plugin-scrollbar-arrow-hover-color: #00000072;
  --plugin-scrollbar-background-color: #FFFFFF00;
  --plugin-scrollbar-background-hover-color: #FFFFFF80;
  --plugin-scrollbar-face-color: #00000072;
  --plugin-scrollbar-face-active-color: #00000072;
  --plugin-scrollbar-face-hover-color: #00000072;
  --plugin-select-option-background-color: #F3F3F3FF;
  --plugin-select-option-color: #000000E4;
  --plugin-select-option-checked-background-color: #5649B0FF;
  --plugin-select-option-checked-border-color: #5649B0FF;
  --plugin-select-option-checked-foreground-color: #FFFFFFFF;
  --plugin-select-option-hover-background-color: #0000000F;
  --plugin-select-option-hover-border-color: #0000000F;
  --plugin-select-option-hover-foreground-color: #000000E4;
  --plugin-select-border-color: #0000000F;
  --plugin-select-background-color: #FFFFFFB2;
  --plugin-select-foreground-color: #000000E4;
  --plugin-select-hover-border-color: #0000000F;
  --plugin-select-hover-background-color: #F9F9F980;
  --plugin-select-hover-foreground-color: #000000E4;
  --plugin-textbox-border-color: #0000000F;
  --plugin-textbox-background-color: #FFFFFFB2;
  --plugin-textbox-color: #000000E4;
  --plugin-textbox-disabled-background-color: #F9F9F94D;
  --plugin-textbox-disabled-border-color: #0000000F;
  --plugin-textbox-disabled-color: #0000005C;
  --plugin-tooltip-text-color: #000000E4;
  --plugin-tooltip-background-color: #F3F3F3FF;
  --plugin-tooltip-border-color: #0000000F;
  --plugin-treeview-content-inactive-selected-background-color: #0000000F;
  --plugin-treeview-content-inactive-selected-color: #0000009E;
  --plugin-treeview-content-selected-background-color: #5649B0FF;
  --plugin-treeview-content-selected-color: #FFFFFFFF;
  --plugin-treeview-content-selected-border-color: #5649B0FF;
  --plugin-treeview-content-background-color: #F3F3F3FF;
  --plugin-treeview-content-color: #000000E4;
  --plugin-treeview-content-mouseover-background-color: #0000000F;
  --plugin-treeview-content-mouseover-color: #000000E4;
  --plugin-scrollbar-up-arrow-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 5.9989C1.14924 5.9989 0.674785 5.09087 1.13603 4.42784L3.76866 0.64342C4.36545 -0.214452 5.6346 -0.214448 6.23138 0.643422L8.86402 4.42784C9.32526 5.09087 8.8508 5.9989 8.04311 5.9989H1.95693Z' fill='%2300000072' /%3E%3C/svg%3E");
  --plugin-scrollbar-up-arrow-active-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 5.9989C1.14924 5.9989 0.674785 5.09087 1.13603 4.42784L3.76866 0.64342C4.36545 -0.214452 5.6346 -0.214448 6.23138 0.643422L8.86402 4.42784C9.32526 5.09087 8.8508 5.9989 8.04311 5.9989H1.95693Z' fill='%23000000E4' /%3E%3C/svg%3E");
  --plugin-scrollbar-up-arrow-hover-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 5.9989C1.14924 5.9989 0.674785 5.09087 1.13603 4.42784L3.76866 0.64342C4.36545 -0.214452 5.6346 -0.214448 6.23138 0.643422L8.86402 4.42784C9.32526 5.09087 8.8508 5.9989 8.04311 5.9989H1.95693Z' fill='%23000000E4' /%3E%3C/svg%3E");
  --plugin-scrollbar-down-arrow-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 0C1.14924 0 0.674785 0.90803 1.13603 1.57107L3.76866 5.35548C4.36545 6.21335 5.6346 6.21335 6.23138 5.35548L8.86402 1.57106C9.32526 0.908027 8.8508 0 8.04311 0H1.95693Z' fill='%2300000072' /%3E%3C/svg%3E");
  --plugin-scrollbar-down-arrow-active-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 0C1.14924 0 0.674785 0.90803 1.13603 1.57107L3.76866 5.35548C4.36545 6.21335 5.6346 6.21335 6.23138 5.35548L8.86402 1.57106C9.32526 0.908027 8.8508 0 8.04311 0H1.95693Z' fill='%23000000E4' /%3E%3C/svg%3E");
  --plugin-scrollbar-down-arrow-hover-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 0C1.14924 0 0.674785 0.90803 1.13603 1.57107L3.76866 5.35548C4.36545 6.21335 5.6346 6.21335 6.23138 5.35548L8.86402 1.57106C9.32526 0.908027 8.8508 0 8.04311 0H1.95693Z' fill='%23000000E4' /%3E%3C/svg%3E");
  --plugin-scrollbar-left-arrow-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M4.42784 8.8403C5.09087 9.29871 5.9989 8.82717 5.9989 8.02443V1.9756C5.9989 1.17287 5.09087 0.701325 4.42784 1.15974L0.643422 3.77622C-0.214448 4.36933 -0.214452 5.6307 0.64342 6.22382L4.42784 8.8403Z' fill='%2300000072' /%3E%3C/svg%3E");
  --plugin-scrollbar-left-arrow-active-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M4.42784 8.8403C5.09087 9.29871 5.9989 8.82717 5.9989 8.02443V1.9756C5.9989 1.17287 5.09087 0.701325 4.42784 1.15974L0.643422 3.77622C-0.214448 4.36933 -0.214452 5.6307 0.64342 6.22382L4.42784 8.8403Z' fill='%23000000E4' /%3E%3C/svg%3E");
  --plugin-scrollbar-left-arrow-hover-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M4.42784 8.8403C5.09087 9.29871 5.9989 8.82717 5.9989 8.02443V1.9756C5.9989 1.17287 5.09087 0.701325 4.42784 1.15974L0.643422 3.77622C-0.214448 4.36933 -0.214452 5.6307 0.64342 6.22382L4.42784 8.8403Z' fill='%23000000E4' /%3E%3C/svg%3E");
  --plugin-scrollbar-right-arrow-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M1.57107 8.8403C0.90803 9.29871 0 8.82717 0 8.02443L0 1.9756C0 1.17287 0.908028 0.701325 1.57106 1.15974L5.35548 3.77622C6.21335 4.36933 6.21335 5.6307 5.35548 6.22382L1.57107 8.8403Z' fill='%2300000072' /%3E%3C/svg%3E");
  --plugin-scrollbar-right-arrow-active-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M1.57107 8.8403C0.90803 9.29871 0 8.82717 0 8.02443L0 1.9756C0 1.17287 0.908028 0.701325 1.57106 1.15974L5.35548 3.77622C6.21335 4.36933 6.21335 5.6307 5.35548 6.22382L1.57107 8.8403Z' fill='%23000000E4' /%3E%3C/svg%3E");
  --plugin-scrollbar-right-arrow-hover-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M1.57107 8.8403C0.90803 9.29871 0 8.82717 0 8.02443L0 1.9756C0 1.17287 0.908028 0.701325 1.57106 1.15974L5.35548 3.77622C6.21335 4.36933 6.21335 5.6307 5.35548 6.22382L1.57107 8.8403Z' fill='%23000000E4' /%3E%3C/svg%3E");
  --plugin-corner-radius-none: 0;
  --plugin-corner-radius-s: 2;
  --plugin-corner-radius-m: 4;
  --plugin-corner-radius-l: 6;
  --plugin-corner-radius-xl: 8;
  --plugin-corner-radius-focus-rect: 6;
  --plugin-spacing-none: 0;
  --plugin-spacing-xxxs: 1;
  --plugin-spacing-xxs: 2;
  --plugin-spacing-xs-nudge: 3;
  --plugin-spacing-xs: 4;
  --plugin-spacing-s-nudge: 6;
  --plugin-spacing-s: 8;
  --plugin-spacing-m-nudge: 10;
  --plugin-spacing-m: 12;
  --plugin-spacing-l: 16;
  --plugin-spacing-xl: 20;
  --plugin-spacing-xxl: 24;
  --plugin-spacing-xxxl: 32;
  --plugin-size-content-min-height: 16;
  --plugin-size-content-min-width: 16;
  --plugin-size-control-min-height: 24;
  --plugin-size-control-min-width: 24;
  --plugin-size-toggle-switch-size: 20;
  --plugin-size-icon-xxs: 8;
  --plugin-size-icon-xs: 12;
  --plugin-size-icon-s: 16;
  --plugin-size-icon-m: 24;
  --plugin-size-icon-l: 32;
  --plugin-size-non-client-control-height: 30;
  --plugin-size-non-client-control-width: 44;
  --plugin-stroke-width-none: 0;
  --plugin-stroke-width-thin: 1;
  --plugin-stroke-width-thick: 2;
  --plugin-stroke-width-thicker: 3;
  --plugin-stroke-width-thickest: 4;
  --plugin-typography-body-line-height: 20;
  --plugin-typography-body-large-line-height: 24;
  --plugin-typography-caption-line-height: 16;
  --plugin-typography-code-line-height: 20;
  --plugin-typography-display-line-height: 92;
  --plugin-typography-subtitle-line-height: 28;
  --plugin-typography-title-line-height: 36;
  --plugin-typography-title-large-line-height: 52;
}

/* CSS file for the plugin's base styles and themes (light / dark / high contrast)
   Light theme values are used as defaults but CSS variables are used to provide the correct value for the active theme.
    Example:
    border-right: 1px solid var(--plugin-background-color, #8591A2);

   The following CSS variables are available to all hosts:
    --plugin-background-color
    --plugin-color
    --plugin-contextmenu-active-color
    --plugin-contextmenu-background-color
    --plugin-contextmenu-border-color
    --plugin-contextmenu-color
    --plugin-contextmenu-hover-color
    --plugin-contextmenu-hover-text-color
    --plugin-contextmenu-icon-checkbox
    --plugin-contextmenu-inactive-text-color
    --plugin-contextmenu-separator-color
    --plugin-error-border-color
    --plugin-font-family
    --plugin-font-size
    --plugin-font-weight
    --plugin-highlight-background-color
    --plugin-highlight-color
    --plugin-inactive-color
    --plugin-link-color
    --plugin-link-active-color
    --plugin-link-hover-color
    --plugin-scrollbar-arrow-background-color
    --plugin-scrollbar-arrow-background-active-color
    --plugin-scrollbar-arrow-background-hover-color
    --plugin-scrollbar-arrow-color
    --plugin-scrollbar-arrow-active-color
    --plugin-scrollbar-arrow-hover-color
    --plugin-scrollbar-background-color
    --plugin-scrollbar-face-color
    --plugin-scrollbar-face-active-color
    --plugin-scrollbar-face-hover-color
    --plugin-select-option-background-color
    --plugin-select-option-color
    --plugin-select-option-checked-background-color
    --plugin-select-option-checked-border-color
    --plugin-select-option-checked-foreground-color
    --plugin-select-option-hover-background-color
    --plugin-select-option-hover-border-color
    --plugin-select-option-hover-foreground-color
    --plugin-select-border-color
    --plugin-select-background-color
    --plugin-select-foreground-color
    --plugin-select-hover-background-color
    --plugin-select-hover-border-color
    --plugin-select-hover-foreground-color
    --plugin-table-border-color
    --plugin-table-header-background-color
    --plugin-table-header-color
    --plugin-textbox-border-color
    --plugin-textbox-background-color
    --plugin-textbox-color
    --plugin-textbox-disabled-background-color
    --plugin-textbox-disabled-border-color
    --plugin-textbox-disabled-color
    --plugin-treeview-content-background-color
    --plugin-treeview-content-color
    --plugin-treeview-content-inactive-selected-color
    --plugin-treeview-content-mouseover-background-color
    --plugin-treeview-content-mouseover-color
    --plugin-treeview-content-inactive-selected-color
    --plugin-treeview-content-selected-background-color
    --plugin-treeview-content-selected-border-color
    --plugin-treeview-content-selected-color

    The following are special values used just for theming scrollbar arrows (they contain a data URL defining an SVG):
    --plugin-scrollbar-up-arrow-url
    --plugin-scrollbar-up-arrow-hover-url
    --plugin-scrollbar-up-arrow-active-url
    --plugin-scrollbar-down-arrow-url
    --plugin-scrollbar-down-arrow-hover-url
    --plugin-scrollbar-down-arrow-active-url
    --plugin-scrollbar-left-arrow-url
    --plugin-scrollbar-left-arrow-hover-url
    --plugin-scrollbar-left-arrow-active-url
    --plugin-scrollbar-right-arrow-url
    --plugin-scrollbar-right-arrow-hover-url
    --plugin-scrollbar-right-arrow-active-url


    VS host also has access to all VS themed color key tokens (EnvironmentColors) and category specific tokens.
    http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.platformui.environmentcolors_properties
    Please see product documentation for instructions on how to add these tokens to the plugin manifest.
 */

/* HTML and body styles */
html, body {
    font-family: var(--plugin-font-family, "Segoe UI", Arial, sans-serif);
    font-size: var(--plugin-font-size, 9pt);
    font-weight: var(--plugin-font-weight, normal);
    color: var(--plugin-color, #1E1E1E);
    background-color: var(--plugin-background-color, #F6F6F6);
}

/* Scroll bars */

::-webkit-scrollbar {
    width: 18px;
    height: 18px;
    background-color: transparent;
}

/* Hover over the scrollbar */
::-webkit-scrollbar:hover {
    background-color: var(--plugin-scrollbar-background-hover-color, #C8C8C833) /* track hover color */
}

::-webkit-scrollbar-corner {
    background-color: transparent;
}

::-webkit-scrollbar:hover::-webkit-scrollbar-corner {
    background-color: var(--plugin-scrollbar-background-hover-color, #C8C8C833) /* match track hover */
}

/* Track */
::-webkit-scrollbar-track {
    background: transparent;
}

/* Thumb */
::-webkit-scrollbar-thumb {
    background-color: var(--plugin-scrollbar-face-color, #6E6E6E);
    border: 8px solid transparent; /* make the thumb appears smaller */
    background-clip: padding-box;
    border-radius: 9px; /* half of the thickness */
}

::-webkit-scrollbar-thumb:hover {
    border: 5px solid transparent; /* make the thumb appears larger */
}

/* Arrows */

::-webkit-scrollbar-button {
    background-color: transparent;
    background-repeat: no-repeat;
    background-position: center;
}

/* Up arrow */

::-webkit-scrollbar-button:start:decrement:vertical {
    background-image: var(--plugin-scrollbar-up-arrow-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:start:decrement:vertical:hover {
    background-image: var(--plugin-scrollbar-up-arrow-hover-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:start:decrement:vertical:active {
    background-image: var(--plugin-scrollbar-up-arrow-active-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

/* Down arrow */

::-webkit-scrollbar-button:end:increment:vertical {
    background-image: var(--plugin-scrollbar-down-arrow-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:end:increment:vertical:hover {
    background-image: var(--plugin-scrollbar-down-arrow-hover-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:end:increment:vertical:active {
    background-image: var(--plugin-scrollbar-down-arrow-active-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

/* Left arrow */

::-webkit-scrollbar-button:start:decrement:horizontal {
    background-image: var(--plugin-scrollbar-left-arrow-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:start:decrement:horizontal:hover {
    background-image: var(--plugin-scrollbar-left-arrow-hover-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:start:decrement:horizontal:active {
    background-image: var(--plugin-scrollbar-left-arrow-active-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

/* Right arrow */

::-webkit-scrollbar-button:end:increment:horizontal {
    background-image: var(--plugin-scrollbar-right-arrow-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:end:increment:horizontal:hover {
    background-image: var(--plugin-scrollbar-right-arrow-hover-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:end:increment:horizontal:active {
    background-image: var(--plugin-scrollbar-right-arrow-active-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

/* Select styles */
select {
    color: var(--plugin-select-foreground-color, #1E1E1E);
    background-color: var(--plugin-select-background-color, #FFFFFF);
    font: var(--plugin-font-weight, normal) var(--plugin-font-size, 9pt) var(--plugin-font-family, "'Segoe UI', Arial, sans-serif");
    border: 1px solid var(--plugin-select-border-color, #CCCEDB);
}

select:hover {
    color: var(--plugin-select-hover-foreground-color, #1E1E1E);
    background-color: var(--plugin-select-hover-background-color, #FFFFFF);
    border: 1px solid var(--plugin-select-hover-border-color, #007ACC);
}

select[multiple],
select option {
    color: var(--plugin-select-option-color, #1E1E1E);
    background-color: var(--plugin-select-option-background-color, #F6F6F6);
    /* Add a transparent border so that text does not move around on hover */
    border: 1px solid transparent;
}

select option:hover {
    color: var(--plugin-select-option-hover-foreground-color, #1E1E1E);
    background-color: var(--plugin-select-option-hover-background-color, #C9DEF5);
    border: 1px solid var(--plugin-select-option-hover-border-color, #C9DEF5);
}

select option:checked {
    color: var(--plugin-select-option-checked-foreground-color, #1E1E1E);
    background-color: var(--plugin-select-option-checked-background-color, #C9DEF5);
    border: 1px solid var(--plugin-select-option-checked-border-color, #C9DEF5);
}

/* Input styles */
input {
    font: var(--plugin-font-weight, normal) var(--plugin-font-size, 9pt) var(--plugin-font-family, "'Segoe UI', Arial, sans-serif");
    color: var(--plugin-textbox-color, #1E1E1E);
    background-color: var(--plugin-textbox-background-color, #FFFFFF);
    border: 1px solid var(--plugin-textbox-border-color, #DBDDE6);
    padding: 0 3px;
}

input:disabled {
    color: var(--plugin-textbox-disabled-color, #A2A4A5);
    background-color: var(--plugin-textbox-disabled-background-color, #FFFFFF);
    border: 1px solid var(--plugin-textbox-disabled-border-color, #DBDDE6);
}

input[type="checkbox"],
input[type="radio"]
 {
    border: none;
    background-color: inherit;
    margin-right: 4px;
    vertical-align: middle;
}

input[type="file"],
input[type="image"]
 {
    border: none;
    background-color: inherit;
    padding: 0;
}

/* TextArea styles */
textarea {
    font-family: var(--plugin-font-family, "Segoe UI"), Arial, sans-serif;
    font-size: var(--plugin-font-size, 9pt);
    font-weight: var(--plugin-font-weight, normal);
    color: var(--plugin-color, #1E1E1E);
    background-color: var(--plugin-textbox-background-color, #F6F6F6);
    border: 1px solid var(--plugin-textbox-border-color, #DBDDE6);
    padding: 0 3px;
    resize: none;
}

/* Button styles */
button,
input[type="button"],
input[type="reset"],
input[type="submit"] {
    color: #000000;
    background-image: -ms-linear-gradient(top, #F0F0F0 0%, #E5E5E5 100%);
    border: 1px solid #ACACAC;
    font-family: var(--plugin-font-family, "Segoe UI"), Arial, sans-serif;
    font-size: var(--plugin-font-size, 9pt);
    font-weight: var(--plugin-font-weight, normal);
    min-width: 73px;
    padding: 1px 19px 2px 19px;
}

button:hover,
input[type="button"]:hover,
input[type="reset"]:hover,
input[type="submit"]:hover {
    background-image: -ms-linear-gradient(top, #ECF4FC 0%, #DCECFC 100%);
    border: 1px solid #7EB4EA;
}

button:focus,
input[type="button"]:focus,
input[type="reset"]:focus,
input[type="submit"]:focus {
    border: 1px solid #569DE5;
}

button:active,
input[type="button"]:active,
input[type="reset"]:active,
input[type="submit"]:active {
    background-image: -ms-linear-gradient(top, #DAECFC 0%, #C4E0FC 100%);
    border: 1px solid #569DE5;
}

button[disabled],
input[type="button"][disabled],
input[type="reset"][disabled],
input[type="submit"][disabled] {
    color: #838383;
    background: #F4F4F4 none;
    border: 1px solid #B1B1B2;
}

/* Other form styles */
fieldset {
    border: 1px solid var(--plugin-textbox-border-color, #DBDDE6);
}

/* Link styles */
a, a:link, a:visited, a:focus {
    color: var(--plugin-link-color, #0E70C0);
    text-decoration: none;
}

a:hover {
    color: var(--plugin-link-hover-color, #0E70C0);
    text-decoration: underline;
}

a:active {
    color: var(--plugin-link-active-color, #0E70C0);
}

/* Table styles */
th {
    color: var(--plugin-table-header-color, #1E1E1E);
    background-color: var(--plugin-table-header-background-color, #EFEFE2);
}

td, th {
    border-color: var(--plugin-table-border-color, #F0F0F0);
}

/* Disabled styles */
:disabled {
    color: var(--plugin-inactive-color, #A2A4A5);
}

/* Highlight styles
   Use this class when you have a highlighted item, for example a highlighted row in a grid */
.plugin-highlight {
    color: var(--plugin-highlight-color, #FFFFFF);
    background-color: var(--plugin-highlight-background-color, #3399FF);
}

/* Tooltip styles
   This class will be included automatically on all tooltips
   In VS tooltips aren't, by default, themed, so we just copy
   the WPF tooltip defaults, which is what VS uses for its tooltips.
   The one exception is that under system high-contrast themes tooltips
   are in fact themed, so we use the !HCOnly to indicate we only want
   our color tokens substituted under high-contrast themes.

   We set its initial display style to none and its initial position
   to (-500,-500) just to ensure that when we insert it into the document
   (for measuring) it isn't visible until we have done the layout and
   calculated its final position.
*/
#plugin-vs-tooltip {
    display: none;
    position: absolute;
    top: -500px;
    left: -500px;
    -ms-high-contrast-adjust: none;
    color: var(--plugin-tooltip-text-color, #575757);
    background-color: var(--plugin-tooltip-background-color, #F1F2F7);
    border: thin solid var(--plugin-tooltip-border-color, #767676);
    padding: 4px 5px 3px 5px;
    line-height: normal;
    box-sizing: border-box;
}

#plugin-vs-tooltip > #plugin-vs-tooltip-nested-cell {
    display: table-cell;
    vertical-align: middle;
    -ms-high-contrast-adjust: none;
    color: var(--plugin-tooltip-text-color, #575757);
    background-color: var(--plugin-tooltip-background-color, #F1F2F7);
}

#plugin-vs-tooltip > #plugin-vs-tooltip-nested-cell > #plugin-vs-tooltip-content {
    -ms-high-contrast-adjust: none;
    color: var(--plugin-tooltip-text-color, #575757);
    background-color: var(--plugin-tooltip-background-color, #F1F2F7);
}

/* Selection styles */
.selectNone {
    -ms-user-select: none;
    user-select: none;
}

.selectElement {
    -ms-user-select: element;
    user-select: auto;
}

/* Context Menu styles */
ul.plugin-contextmenu {
    background-color: var(--plugin-contextmenu-background-color, #e9e8ea);
    border: thin solid var(--plugin-contextmenu-border-color, #cdd0d6);
    color: var(--plugin-contextmenu-color, #1E1E1E);
    padding: 1px 2px 2px 2px;
    margin: 0;
    position: absolute;
    display: none;
    outline: none;
    z-index: 100;
    white-space: nowrap;
    -ms-high-contrast-adjust: none;
    line-height: normal;
}

.plugin-contextmenu .menuitem {
    display: flex;
    align-items: center;
    /* VS context menu max width: https://devdiv.visualstudio.com/DevDiv/_git/VS?path=/src/env/shell/UIInternal/MainWindow/Controls/VsMenuItem.cs&version=GBmain&line=85&lineEnd=92&lineStartColumn=9&lineEndColumn=10&lineStyle=plain&_a=contents */
    max-width: 660px;
    cursor: default;
    outline: none;
    list-style: none;
    margin-top: 1px;
    border: 1px solid transparent;
    box-sizing: border-box;
}

.plugin-contextmenu .menuitem:focus {
    background-color: var(--plugin-contextmenu-hover-color, #f9f9fa);
    color: var(--plugin-contextmenu-hover-text-color, #1E1E1E);
    border-color: var(--plugin-contextmenu-hover-border-color);
}

.plugin-contextmenu .menuitem:active,
.plugin-contextmenu .active {
    background-color: var(--plugin-contextmenu-active-color, #f9f9fa);
    color: var(--plugin-contextmenu-hover-text-color, #1E1E1E);
    border-color: var(--plugin-highlight-background-color);
}

.plugin-contextmenu .disabled:hover,
.plugin-contextmenu .disabled:active,
.plugin-contextmenu .disabled:focus,
.plugin-contextmenu .disabled {
    background-color: var(--plugin-contextmenu-background-color, #e9e8ea);
    color: var(--plugin-contextmenu-inactive-text-color, #a2a4a5);
}

.plugin-contextmenu .menuitem .icon {
    margin: 0 10px 0 6px;
    background-color: transparent;
    width: 16px;
    height: 16px;
}

.plugin-contextmenu .menuitem .checkbox {
    background-image: var(--plugin-contextmenu-icon-checkbox, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/PbtGwMpgAWIfXx8iFS9ZcsWJgYSAQuctW7tejzqgoIDIQx8Nrx69QqobvKUyciC+DSsXLUSSIaHhROlAWj8/v37HB2dxMTEiNKA1Xh0DR2dHUBHvwIDrMajhBIQJCUmnTp1EmI2VuPRNQDNA5oKNBvIxmo8Fj/ATcVqPLoNEEvwxyALZlziBySnJUZSkzdAgAEAfm84vuieuk0AAAAASUVORK5CYII=));
}

.plugin-contextmenu .hidden {
    display: none;
}

.plugin-contextmenu .disabled {
    color: var(--plugin-contextmenu-inactive-text-color, #a2a4a5);
}

.plugin-contextmenu .menuitem .main {
    padding: 4px 50px 5px 0;
    margin-right: auto;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
}

.plugin-contextmenu .menuitem .shortcut {
    min-width: 25px;
    flex-shrink: 0;
    padding-right: 25px;
}

.plugin-contextmenu .menuitem .arrow {
    overflow: visible;
}

.plugin-contextmenu .menuitem .arrow:before,
.plugin-contextmenu .menuitem.disabled:hover .arrow:before,
.plugin-contextmenu .menuitem.disabled:active .arrow:before,
.plugin-contextmenu .menuitem.disabled:focus .arrow:before,
.plugin-contextmenu .menuitem.disabled .arrow:before {
    content: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAHCAYAAADAp4fuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNpiWL5i5X8gYEDGTKdOnmCYOXP2fwYkwAQibt68ztDXP+E/iiAIPHn8iGHChIn/UQSFhIQZCgryGUFsFhAhIyvHUFRYwAg3dMaMWRi2AwQYAAcRMJwq3CX+AAAAAElFTkSuQmCC);
}

.plugin-contextmenu .menuitem:hover .arrow:before,
.plugin-contextmenu .menuitem:active .arrow:before,
.plugin-contextmenu .menuitem:focus .arrow:before,
.plugin-contextmenu .active .arrow:before {
    content: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAHCAYAAADAp4fuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFRJREFUeNpiKNzy6D8QMCBjBoaqM/+DltxGkWACCjOsu/aRwXrmDZASMGCCMY49+spgP/vmfxRBdRF2hoOp6oxwQSs5boYbhTqMMAUM6JaAMECAAQDqqjmrw1gHVwAAAABJRU5ErkJggg==);
}

.plugin-contextmenu .menuitem[role="separator"] > * {
    height: 0;
}

.plugin-contextmenu .menuitem .hr,
.plugin-contextmenu .menuitem:hover .hr,
.plugin-contextmenu .menuitem:active .hr,
.plugin-contextmenu .menuitem:focus .hr,
.plugin-contextmenu .active .hr {
    height: 1px;
    width: 100%;
    background-color: var(--plugin-contextmenu-separator-color, #cdd0d6);
    padding: 0;
}
</style>
    <script src="http://scriptedhost.vs/plugin.js" type="text/javascript" class="selectNone"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" class="selectNone">
    <meta charset="utf-8" class="selectNone">
    <link rel="stylesheet" href="c:\program files\microsoft visual studio\18\insiders\common7\ide\commonextensions\microsoft\markdown\Preview\Dependencies\highlight.css" id="CSSTheme" class="selectNone">
    <link rel="stylesheet" href=" " id="FontSize" class="selectNone">
    <script type="text/javascript" src="./DOMPurify/purify.min.js" id="DomPurifyTag" class="selectNone"></script>
    <script type="text/javascript" src="./daytonaHtmlContextMenu.js" id="HTMLContextMenuScript" class="selectNone"></script>
    <script type="text/javascript" src="./mermaidJS/mermaid.min.js" class="selectNone"></script>
    <style class="selectNone">
        html, body {
        }
    </style>
    <title class="selectNone">Markdown Preview</title>
    <meta http-equiv="cache-control" content="no-cache" class="selectNone">
<base href="file://C:/D/Work/Training/OOD/AppInfra-repo/.Practice/readme.md"><base><base><base><base></head>
<body class="selectNone">
    <div id="___markdown-content___" class="selectNone" data-plugin-contextmenu="plugin-contextmenu-c838210c-bd3d-7bb9-53be-34a22afb1b39"><h1 id="this-file-contains-exercises-based-on-the-appinfra-demo"><a id="pragma-line-0"></a>This file contains exercises based on the AppInfra demo</h1>
<h2 id="notifications-module"><a id="pragma-line-2"></a>0. Notifications Module</h2>
<blockquote id="pragma-line-4">
<p id="pragma-line-4"><strong>Objective:</strong> Get familiar with the DemoApp, and understand how the Bootstrapper, Application Initialization, Dependency Injection, and Service Locator work.</p>
</blockquote>
<h3 id="explore-the-appinfrademo-solution"><a id="pragma-line-6"></a>0.1 Explore the AppInfraDemo solution</h3>
<ul id="pragma-line-7">
<li id="pragma-line-7">Look at the <code>ConsoleUi</code> project — it is the host process.</li>
<li id="pragma-line-8">Look at the <code>AppBoot</code> folder — it contains the Bootstrapper and initialization logic.</li>
<li id="pragma-line-9">Look at the <code>Contracts</code> folder — it contains the service contracts exposed by the modules.</li>
</ul>
<h3 id="notifications-services"><a id="pragma-line-11"></a>0.2 Notifications Services</h3>
<ul id="pragma-line-12">
<li id="pragma-line-12">Explore the <code>Notification.Services</code> project:
<ul id="pragma-line-13">
<li id="pragma-line-13"><code>NotificationService</code> is used to send notifications.</li>
<li id="pragma-line-14"><code>StateChangeSubscriber</code> shows how a subscriber may be implemented.</li>
<li id="pragma-line-15">The <code>ConsoleUi</code> implements <code>IAmAliveSubscriber&lt;IModule&gt;</code> to write a message to the console when a new module becomes active.</li>
</ul>
</li>
<li id="pragma-line-16">Understand how <em>"NotificationsModule is alive!"</em> appears on the console during application startup.</li>
</ul>
<hr id="pragma-line-18">
<h2 id="sales-module"><a id="pragma-line-20"></a>1. Sales Module</h2>
<h3 id="optionaladvanced-add-sales-module-and-sales.services-project-to-the-solution"><a id="pragma-line-22"></a>1.0 [Optional][Advanced] Add Sales Module and Sales.Services project to the solution</h3>
<blockquote id="pragma-line-24">
<p id="pragma-line-24">This exercise is optional. To complete it, you need to go back in history and check out the <code>practice-1.0</code> tag.</p>
</blockquote>
<p id="pragma-line-26">Steps:</p>
<ul id="pragma-line-27">
<li id="pragma-line-27">Create a <code>Modules\Sales</code> solution folder and the corresponding <code>.\Modules\Sales</code> folder in the source tree.
<ul id="pragma-line-28">
<li id="pragma-line-28">⚠️ The naming conventions and folder structure matter!</li>
</ul>
</li>
<li id="pragma-line-29">Add the <code>Sales.Services</code> project to the solution inside this new folder.</li>
<li id="pragma-line-30">Understand how an application with plugins works in .NET (see <a href="https://learn.microsoft.com/en-us/dotnet/core/tutorials/creating-app-with-plugin-support">Microsoft Docs</a>):
<ul id="pragma-line-31">
<li id="pragma-line-31">Add <code>&lt;EnableDynamicLoading&gt;true&lt;/EnableDynamicLoading&gt;</code> to the <code>Sales.Services.csproj</code> file (see <code>Notifications.Services.csproj</code> for reference).</li>
<li id="pragma-line-32">Understand how <code>AppBoot</code> loads plugins:
<ul id="pragma-line-33">
<li id="pragma-line-33">Check the <code>AppBoot.AssemblyLoad</code> namespace.</li>
<li id="pragma-line-34">Review the <code>BreadcrumbNameConventionPathBuilder</code> and <code>PluginAssemblyLoader</code> classes to see why naming and folder conventions are important.</li>
</ul>
</li>
</ul>
</li>
<li id="pragma-line-35">Set up <code>Sales.Services</code> as a solution dependency of <code>ConsoleUi</code> (so it builds automatically when <code>ConsoleUi</code> is built for debug / F5).</li>
<li id="pragma-line-36">Configure the <code>Sales.Services</code> plugin in <code>AppBoot</code>:
<ul id="pragma-line-37">
<li id="pragma-line-37">In <code>ConsoleUi/Program.cs</code>, inside the AppBoot setup:
<ul id="pragma-line-38">
<li id="pragma-line-38">Ensure the <code>NameFilter</code> allows <code>Sales.*</code> assemblies.</li>
<li id="pragma-line-39">Add <code>.AddPlugin("Sales.Services")</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="sales-services-module"><a id="pragma-line-41"></a>1.1 Sales Services Module</h3>
<p id="pragma-line-43">Add a <code>SalesServicesModule : IModule</code> and make it send a notification when it becomes active.</p>
<p id="pragma-line-45">Use <code>NotificationsModule</code> as a model and see how its <em>“I’m alive”</em> notification is displayed in the console application.</p>
<h3 id="change-the-module-initialization-order-in-a-loosely-coupled-way"><a id="pragma-line-47"></a>1.2 Change the module initialization order in a loosely coupled way</h3>
<p id="pragma-line-49">Use the <code>PriorityAttribute</code> and the <code>OrderByPriority&lt;T&gt;()</code> helper method from <code>AppBoot.SystemEx.Priority</code>.</p>
<hr id="pragma-line-52">
<h2 id="console-application"><a id="pragma-line-54"></a>2. Console Application</h2>
<blockquote id="pragma-line-56">
<p id="pragma-line-56"><strong>Objective:</strong> Understand AppBoot basics — Modules, Dependency Injection, and Service Locator.</p>
</blockquote>
<h3 id="transform-the-ordersconsoleapplication-into-an-imodule"><a id="pragma-line-58"></a>2.1 Transform the OrdersConsoleApplication into an IModule</h3>
<ul id="pragma-line-60">
<li id="pragma-line-60">Make the <code>OrdersConsoleApplication</code> class implement the <code>IModule</code> interface.</li>
<li id="pragma-line-61">Consider renaming it so the name clearly indicates it represents a module.</li>
<li id="pragma-line-62">The <code>Program.Main()</code> method should no longer directly depend on this class.</li>
<li id="pragma-line-63">After refactoring, the menu should be shown from the <code>IModule.Initialize()</code> method instead of <code>Main()</code>.</li>
</ul>
<h3 id="optional-unit-test-the-init-function-of-the-resulting-module"><a id="pragma-line-65"></a>2.2 [Optional] Unit test the <code>Init()</code> function of the resulting module</h3>
<ul id="pragma-line-67">
<li id="pragma-line-67">Identify the external dependencies of the module.</li>
<li id="pragma-line-68">Discuss when to use <em>stubs</em> and when to use <em>mocks</em>.</li>
</ul>
<hr id="pragma-line-71">
<h2 id="create-a-composite-console-application"><a id="pragma-line-73"></a>3. Create a Composite Console Application</h2>
<blockquote id="pragma-line-75">
<p id="pragma-line-75"><strong>Objective:</strong> Understand how to benefit from AppBoot’s type discovery and loosely coupled modules.</p>
</blockquote>
<h3 id="create-a-console-ui-module-that-discovers-commands-and-builds-a-menu-from-them"><a id="pragma-line-77"></a>3.1 Create a Console UI Module that discovers commands and builds a menu from them</h3>
<p id="pragma-line-79">Follow the steps below as guidance:</p>
<p id="pragma-line-81">Step a) Create the <code>IConsoleCommand</code> interface as shown:</p>
<pre><code class="language-csharp" id="pragma-line-83">public interface IConsoleCommand
{
    void Execute();
    string MenuLabel { get; }
}
</code></pre>
<p id="pragma-line-91">Step b) Create the <code>ConsoleUiModule</code> class that implements <code>IModule</code>.<br>
It should discover all <code>IConsoleCommand</code> implementations and build a menu from them inside its <code>Initialize()</code> method.</p>
<p id="pragma-line-94">Step c) Transform the <code>OrdersConsoleModule</code> into an <code>IConsoleCommand</code> implementation.</p>
<p id="pragma-line-96">This setup will allow any other functional module to provide its own <code>IConsoleCommand</code> implementations.<br>
The <code>ConsoleUiModule</code> will automatically discover them and present them to the user for execution, resulting in a loosely coupled relationship between the modules and their UI commands.</p>
<hr id="pragma-line-99">
<h3 id="update-the-solution-structure-so-that-each-module-can-have-its-own-console-commands-independent-of-the-host-process-or-ui-app"><a id="pragma-line-101"></a>3.2 Update the solution structure so that each module can have its own console commands, independent of the host process or UI app</h3>
<p id="pragma-line-103">Currently, the <code>OrdersConsoleCommand</code>—created from transforming the <code>OrdersConsoleModule</code> into an <code>IConsoleCommand</code>—resides in the <code>ConsoleApplication</code> project, even though it’s closely related to the <em>Sales</em> module.</p>
<p id="pragma-line-105">We can move it to a new project inside the <em>Sales</em> module folder structure.<br>
The <code>CompositeConsoleUiModule</code> should then discover and use it.</p>
<p id="pragma-line-108">The resulting <code>CompositeConsoleUiModule</code> should <strong>not</strong> depend directly on <code>Sales.Services</code> (to avoid coupling with implementation details), but it <strong>should</strong> depend on <code>Contracts</code>, as it requires access to the <code>IConsoleCommand</code> interface.</p>
<p id="pragma-line-110"><strong>Hints:</strong></p>
<ol id="pragma-line-111">
<li id="pragma-line-111">The new project should be a class library — it can be deployed in any .NET process.</li>
<li id="pragma-line-112">The project should be loaded as a plugin, in a similar way to <code>Sales.Services</code>.</li>
</ol>
<p id="pragma-line-114">Assemblies from any module (including <em>Sales</em>) should not depend on the <code>ConsoleUi</code> assembly, which is the host process and UI.<br>
The dependency should go the other way around — we can invert it by moving the <code>IConsoleCommand</code> and <code>IConsole</code> interfaces into the <code>Contracts</code> assembly, under a new <code>ConsoleUi</code> folder.</p>
<blockquote id="pragma-line-117">
<p id="pragma-line-117"><strong>Observation:</strong><br>
By doing this, we decouple the application from its UI.<br>
All <code>ConsoleCommand</code> implementations could be displayed and executed from another host or UI, such as a WPF or web application.</p>
</blockquote>
<blockquote id="pragma-line-121">
<p id="pragma-line-121"><strong>Observation:</strong><br>
Review the references by generating a <em>Project Dependency Diagram</em>.</p>
</blockquote>
<hr id="pragma-line-124">
<h3 id="order-the-menu-entries"><a id="pragma-line-126"></a>3.3 Order the menu entries</h3>
<ol id="pragma-line-128" type="a">
<li id="pragma-line-128">In a declarative manner.</li>
<li id="pragma-line-129">By module, and then by additional entries within the same module.</li>
</ol>
<hr id="pragma-line-131">
<h2 id="customer-orders-service"><a id="pragma-line-134"></a>4. Customer Orders Service</h2>
<blockquote id="pragma-line-136">
<p id="pragma-line-136"><strong>Objective:</strong> Understand DataAccess implementation.</p>
</blockquote>
<p id="pragma-line-138">All the following exercises should be called through a simple UI, such as the Console UI built in the previous labs.</p>
<hr id="pragma-line-140">
<h3 id="create-a-new-service-in-the-sales-module-that-returns-all-customers-with-orders-ordered-by-company-name"><a id="pragma-line-142"></a>4.1 Create a new service in the Sales module that returns all customers with orders, ordered by company name</h3>
<p id="pragma-line-144">[Optional] Write unit tests for this service. Include tests that verify whether the <code>OrderBy</code> is applied correctly.</p>
<p id="pragma-line-146"><strong>Hint (LINQ query):</strong></p>
<pre><code class="language-csharp" id="pragma-line-148">Customers
    .Where(c =&gt; c.SalesOrderHeaders.Any())
    .OrderBy(c =&gt; c.CompanyName)
    .Select(c =&gt; new CustomerData
    {
        Id = c.CustomerID,
        CompanyName = c.CompanyName,
        SalesPerson = c.SalesPerson
    });
</code></pre>
<hr id="pragma-line-160">
<h3 id="optional-add-more-filters-and-understand-how-to-unit-test-them-by-leveraging-the-irepository-interfaces-testability"><a id="pragma-line-162"></a>4.2 [Optional] Add more filters and understand how to unit test them by leveraging the <code>IRepository</code> interface’s testability</h3>
<ul id="pragma-line-164">
<li id="pragma-line-164">Show only the customers whose company name starts with a string read from the console.</li>
<li id="pragma-line-165">Show only the customers whose company contains a string read from the console.</li>
<li id="pragma-line-166">Write unit tests for the above cases.</li>
</ul>
<hr id="pragma-line-168">
<h3 id="create-a-console-command-that-sets-the-status-of-all-orders-for-a-given-customer"><a id="pragma-line-170"></a>4.3 Create a console command that sets the status of all orders for a given customer</h3>
<ul id="pragma-line-172">
<li id="pragma-line-172">Add a new operation in the <code>OrderingService</code> that sets the status of all orders for a specific customer.</li>
<li id="pragma-line-173">Read the relevant customer information from the console to find the orders whose status needs to be changed.</li>
<li id="pragma-line-174">The new status can be read from the console or hardcoded for simplicity.</li>
</ul>
<blockquote id="pragma-line-176">
<p id="pragma-line-176"><strong>Hint:</strong><br>
See the <code>SalesOrderHeaderStatusValues</code> class for possible values of the <code>SalesOrderHeader.Status</code> property.</p>
</blockquote>
<hr id="pragma-line-179">
<h2 id="dataaccess.entityinterceptors"><a id="pragma-line-181"></a>5. DataAccess.EntityInterceptors</h2>
<blockquote id="pragma-line-183">
<p id="pragma-line-183"><strong>Objective:</strong> Understand and use EntityInterceptors.</p>
</blockquote>
<p id="pragma-line-185">Use <code>EntityInterceptors</code> and <code>INotificationService</code> to implement the following exercises:</p>
<hr id="pragma-line-187">
<h3 id="implement-an-istatechangesubscribersalesorderheader-that-logs-to-the-console-when-a-salesorderheader-is-created-deleted-or-changed"><a id="pragma-line-189"></a>5.1 Implement an <code>IStateChangeSubscriber&lt;SalesOrderHeader&gt;</code> that logs to the console when a <code>SalesOrderHeader</code> is created, deleted, or changed</h3>
<p id="pragma-line-191">The <code>IStateChangeSubscriber</code> will be notified through the <code>Notifications.Services.NotificationService</code>. This will also allow other subscribers to be notified when a <code>SalesOrderHeader</code> entity is created, deleted, or changed.</p>
<p id="pragma-line-193">What classes do need to work together to achieve this?
How are we notified when an entity is created, deleted, or changed?</p>
<p id="pragma-line-196"><strong>Hints:</strong></p>
<ul id="pragma-line-197">
<li id="pragma-line-197">Understand the difference between <code>GlobalEntityInterceptors</code> and <code>EntityInterceptors</code>.</li>
<li id="pragma-line-198">Review the <code>InterceptorsResolver</code> to see how they are applied.</li>
<li id="pragma-line-199">Check the template implementations:
<ul id="pragma-line-200">
<li id="pragma-line-200"><code>InterceptorsResolver : IInterceptorsResolver</code></li>
<li id="pragma-line-201"><code>GlobalEntityInterceptor&lt;T&gt; : IEntityInterceptor&lt;T&gt;</code></li>
</ul>
</li>
<li id="pragma-line-202">Decide which implementation should be applied in this case.</li>
<li id="pragma-line-203"></li>
</ul>
<p id="pragma-line-205">The <code>IStateChangeSubscriber&lt;SalesOrderHeader&gt;</code>should be part of the <em>Sales</em> module. Which project should it go into?</p>
<h3 id="implement-a-default-istatechangesubscribert-that-writes-to-a-text-file-when-any-dto-is-created-deleted-or-changed"><a id="pragma-line-208"></a>5.2 Implement a default <code>IStateChangeSubscriber&lt;T&gt;</code> that writes to a text file when any DTO is created, deleted, or changed</h3>
<p id="pragma-line-210">This should be part of the <em>Notifications</em> module.</p>
<blockquote id="pragma-line-212">
<p id="pragma-line-212"><strong>Observation:</strong><br>
Compare and discuss the differences in how and where the notifications are triggered.</p>
</blockquote>
<hr id="pragma-line-215">
<h2 id="add-entity-auditing"><a id="pragma-line-217"></a>6. Add Entity Auditing</h2>
<blockquote id="pragma-line-219">
<p id="pragma-line-219"><strong>Objective:</strong> Understand how DataAccess enables low-cost feature additions.</p>
</blockquote>
<h3 id="consistently-set-the-modifieddate-for-all-entities-that-have-this-column"><a id="pragma-line-221"></a>6.1 Consistently set the <code>ModifiedDate</code> for all entities that have this column</h3>
<ul id="pragma-line-223">
<li id="pragma-line-223">Currently, when modifying an order in exercise 4.3 or adding persons in exercise 7, the <code>ModifiedDate</code> is not being set.</li>
<li id="pragma-line-224">One approach would be to manually update the <code>ModifiedDate</code> in all use cases where entities are created or modified. However, this is <strong>cumbersome and error-prone</strong>.</li>
<li id="pragma-line-225">Instead, we should leverage the encapsulated Data Access layer and extend the infrastructure with an <strong>interceptor</strong> that automatically sets this value for all relevant entities.</li>
</ul>
<p id="pragma-line-227">The interface that should be implemented by the data model entities could look like:</p>
<pre><code class="language-csharp" id="pragma-line-229">interface IAuditable
{
    DateTime ModifiedDate { get; set; }
}
</code></pre>
<ul id="pragma-line-236">
<li id="pragma-line-236">Make all entities from the <code>Sales.DataModel</code>, which have the <code>ModifiedDate</code> property to implement this interface.</li>
<li id="pragma-line-237">Create an global entity interceptor that sets the <code>ModifiedDate</code> to <code>DateTime.UtcNow</code> whenever an entity implementing <code>IAuditable</code> is created or modified.</li>
</ul>
<p id="pragma-line-239">Questions:</p>
<ul id="pragma-line-240">
<li id="pragma-line-240">Which kind of interceptor should be used here?</li>
<li id="pragma-line-241">How should we register this interceptor so that it is applied to all relevant entities?</li>
</ul>
<hr id="pragma-line-243">
<h2 id="products-management-module"><a id="pragma-line-245"></a>7. Products Management Module</h2>
<hr id="pragma-line-247">
<h3 id="add-a-new-module-productsmanagement"><a id="pragma-line-249"></a>7.0 Add a new module: <code>ProductsManagement</code></h3>
<blockquote id="pragma-line-251">
<p id="pragma-line-251"><strong>Objective:</strong> Understand how to add new modules to the Application Infrastructure.</p>
</blockquote>
<ul id="pragma-line-253">
<li id="pragma-line-253">Create a new module <code>ProductsManagement</code> in the <code>Modules\ProductsManagement</code> folder.</li>
<li id="pragma-line-254">Create a new project <code>ProductsManagement.Services</code> in this folder.</li>
<li id="pragma-line-255">Implement the class <code>ProductsManagementModule : IModule</code> that sends a notification when it becomes active.</li>
<li id="pragma-line-256">Add <code>ProductsManagement.Services</code> as a plugin in the AppBoot setup.</li>
<li id="pragma-line-257">Create the <code>Products.DataModel</code> project under the <code>Modules\ProductsManagement</code> folder.
<ul id="pragma-line-258">
<li id="pragma-line-258">Map only the product-related entities (e.g., <code>Product</code>, <code>ProductCategory</code>, <code>ProductModel</code>).</li>
</ul>
</li>
<li id="pragma-line-259">Create the <code>Products.DbContext</code> project in the same folder.
<ul id="pragma-line-260">
<li id="pragma-line-260">Implement <code>IDbContextFactory</code> to provide the <code>DbContext</code> for the <code>Products.DataModel</code>.</li>
</ul>
</li>
</ul>
<hr id="pragma-line-262">
<h3 id="add-a-new-productcategory"><a id="pragma-line-264"></a>7.1 Add a new <code>ProductCategory</code></h3>
<blockquote id="pragma-line-266">
<p id="pragma-line-266"><strong>Objective:</strong> Understand how existing Application Infrastructure capabilities can be reused by new modules.</p>
</blockquote>
<hr id="pragma-line-268">
<h3 id="create-support-for-reading-an-entity-from-the-console"><a id="pragma-line-270"></a>7.1.1 Create support for reading an entity from the console</h3>
<ul id="pragma-line-272">
<li id="pragma-line-272">Use the interfaces below and add them to the <code>Contracts</code> project so that they can be reused by multiple modules.</li>
</ul>
<pre><code class="language-csharp" id="pragma-line-274">interface IEntityReader
{
    IEntityFieldsReader&lt;T&gt; BeginEntityRead&lt;T&gt;();
}

interface IEntityFieldsReader&lt;T&gt;
{
    IEnumerable&lt;string&gt; GetFields();
    void SetFieldValue(string value);
    T GetEntity();
}
</code></pre>
<ul id="pragma-line-288">
<li id="pragma-line-288">Create implementations of these interfaces in the <code>ConsoleUi</code> project.</li>
<li id="pragma-line-289">Create a console command in the <code>ProductsManagement</code> module that uses these interfaces to read the data required to create a <code>ProductCategory</code> entity.
<ul id="pragma-line-290">
<li id="pragma-line-290">In this step, only read the data — do not persist it yet.</li>
</ul>
</li>
</ul>
<hr id="pragma-line-292">
<h3 id="create-a-service-that-adds-a-new-productcategory-to-the-system"><a id="pragma-line-294"></a>7.1.2 Create a service that adds a new <code>ProductCategory</code> to the system</h3>
<ul id="pragma-line-296">
<li id="pragma-line-296">Add a service in the <code>ProductsManagement</code> module that adds a new <code>ProductCategory</code> to the database.
<ul id="pragma-line-297">
<li id="pragma-line-297">The service should use the <code>IUnitOfWork</code> from the <code>DataAccess</code> layer.</li>
</ul>
</li>
<li id="pragma-line-298">The console command created earlier (which reads the product category info) should now use this service to insert the newly read product category.</li>
</ul>
<blockquote id="pragma-line-300">
<p id="pragma-line-300"><strong>Observation:</strong><br>
Notice how the interceptors created in exercises 5 and 6 are automatically triggered when a new <code>ProductCategory</code> is added.</p>
</blockquote>
<hr id="pragma-line-303">
<h2 id="persons-managemnt-module"><a id="pragma-line-305"></a>8. Persons Managemnt Module</h2>
<h3 id="add-a-new-module-personsmanagementmodule"><a id="pragma-line-307"></a>8.0 Add a new Module <code>PersonsManagementModule</code></h3>
<blockquote id="pragma-line-309">
<p id="pragma-line-309">!Objectives:</p>
<ol id="pragma-line-310">
<li id="pragma-line-310">Understand how to add new modules to this Application Infrastructure</li>
</ol>
</blockquote>
<ol id="pragma-line-311">
<li id="pragma-line-311">Add new table to the database</li>
<li id="pragma-line-312">Use services from one module into other</li>
</ol>
<ul id="pragma-line-314">
<li id="pragma-line-314">Create a new module <code>PersonsManagementModule</code> in the <code>Modules\PersonsManagement</code> folder</li>
<li id="pragma-line-315">Create a new project <code>PersonsManagement.Services</code> in this folder</li>
<li id="pragma-line-316">Create the <code>PersonsManagementModule : IModule</code> class that notifies when it is alive</li>
<li id="pragma-line-317">Add the <code>PersonsManagement.Services</code> as a plugin in the AppBoot</li>
<li id="pragma-line-318">Create a new Schema (<code>Persons</code>) in the <code>AdventureWorks</code> database to host the new <code>Person</code> table
<ul id="pragma-line-319">
<li id="pragma-line-319">Create a new table <code>Person</code> in the <code>Persons</code> schema with the columns similar to the <code>Customer</code> table</li>
</ul>
</li>
<li id="pragma-line-320">Create the <code>Persons.DataModel</code> project in the <code>Modules\PersonsManagement</code> folder
<ul id="pragma-line-321">
<li id="pragma-line-321">Map the <code>Person</code> table to an entity</li>
</ul>
</li>
<li id="pragma-line-322">Create the <code>Persons.DbContext</code> project in the <code>Modules\PersonsManagement</code> folder
<ul id="pragma-line-323">
<li id="pragma-line-323">Implement the <code>IDbContextFactory</code> to provide the <code>DbContext</code> for the <code>Persons.DataModel</code></li>
</ul>
</li>
</ul>
<h3 id="add-a-new-person"><a id="pragma-line-325"></a>8.1. Add a new <code>Person</code></h3>
<blockquote id="pragma-line-327">
<p id="pragma-line-327">!Objective: See how existent Application Infrastructure capabilities are used by new features of new Modules</p>
</blockquote>
<h3 id="create-support-to-read-a-entity-from-the-console"><a id="pragma-line-329"></a>7.1.1. Create support to read a entity from the console</h3>
<p id="pragma-line-331">Use the following interfaces:</p>
<pre><code id="pragma-line-333">interface IEntityReader
{
    IEntityFieldsReader&lt;T&gt; BeginEntityRead&lt;T&gt;();
}

interface IEntityFieldsReader&lt;T&gt;
{
    IEnumerable&lt;string&gt; GetFields();
    void SetFieldValue(string value);
    T GetEntity();
}
</code></pre>
<p id="pragma-line-347">Read the data needed to create a <code>Person</code> entity</p>
<h3 id="create-a-service-that-adds-a-new-person-to-the-system"><a id="pragma-line-349"></a>8.1.2. Create a service that adds a new <code>Person</code> to the system</h3>
<p id="pragma-line-351">The above console command which reads the product category info should use this service to add the new read product category.</p>
<blockquote id="pragma-line-353">
<p id="pragma-line-353">!Observe: how the interceptors created in ex. 5 &amp; 6 are working when a new ProductCategory is added</p>
</blockquote>
<h3 id="import-persons-as-new-customers"><a id="pragma-line-355"></a>8.1.3. Import persons as new customers</h3>
<blockquote id="pragma-line-357">
<p id="pragma-line-357">!Objective: Use one service from a module into another module</p>
</blockquote>
<ul id="pragma-line-359">
<li id="pragma-line-359">Create a service in the <code>PersonsManagementModule</code> that gives all persons</li>
<li id="pragma-line-360">Create a service in the <code>SalesModule</code> that imports all persons as new customers
<ul id="pragma-line-361">
<li id="pragma-line-361">Decide upon a key / Modified data or other criteria to know which persons should be imported as new customers and were not yet imported</li>
</ul>
</li>
</ul>
</div>

<div id="plugin-contextmenu-container" class="selectNone"><ul id="plugin-contextmenu-c838210c-bd3d-7bb9-53be-34a22afb1b39" class="plugin-contextmenu" data-plugin-is-contextmenu="true" style="display: none;"><li class="menuitem disabled" tabindex="1" role="menuitem" id="Copy" data-plugin-contextmenu-item-type="command" aria-disabled="true"><img class="icon" style="visibility: hidden;"><div class="main">Copy</div></li><li class="menuitem" tabindex="2" role="menuitem" id="Save" data-plugin-contextmenu-item-type="command"><img class="icon" style="visibility: hidden;"><div class="main">Save As HTML... </div></li><li class="menuitem" tabindex="3" role="menuitem" id="Print" data-plugin-contextmenu-item-type="command"><img class="icon" style="visibility: hidden;"><div class="main">Print HTML...</div></li></ul></div></body>