<head class="selectNone"><style type="text/css" id="pluginCss">:root {
  --plugin-contextmenu-icon-checkbox: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACwSURBVDhPzZOxDYMwEEUfUTYAeu+BZyATUBiXESMBBUVowwxmGmAGaKIIWQY7osmvfPel99xcJIRYuZBICLF2XWfvg1IUBTd7+Wvu+6HUaj8epqnb7zvoB2mc0NQtWmm7CgPk+QOAYXjblR+QxgmZlIzGMC2zXfsBZ3ZcgOpZ0dQtaZx47bgAff+Cj9lnxwWYlpnRGDIpvXZcACzjmZ0jwLTMlFpRanVq5y9uIbp6zhueuESbUFx5DQAAAABJRU5ErkJggg==);
  --plugin-default-grayscale-bias-opacity: 0.25;
  --plugin-font-family: "Segoe UI";
  --plugin-font-size: 9pt;
  --plugin-font-weight: normal;
  --plugin-color: #FFFFFFFF;
  --plugin-contextmenu-active-color: #FFFFFF0F;
  --plugin-contextmenu-background-color: #202020FF;
  --plugin-contextmenu-border-color: #0000001A;
  --plugin-contextmenu-color: #FFFFFFFF;
  --plugin-contextmenu-hover-color: #FFFFFF0F;
  --plugin-contextmenu-hover-text-color: #FFFFFFFF;
  --plugin-contextmenu-hover-border-color: #FFFFFF12;
  --plugin-contextmenu-inactive-text-color: #FFFFFF5D;
  --plugin-contextmenu-separator-color: #FFFFFF15;
  --plugin-background-color: #202020FF;
  --plugin-error-border-color: #FF99A4FF;
  --plugin-inactive-color: #FFFFFF5D;
  --plugin-link-color: #99EBFFFF;
  --plugin-link-hover-color: #60CDFFFF;
  --plugin-link-active-color: #60CDFFFF;
  --plugin-table-header-color: #FFFFFFFF;
  --plugin-table-header-background-color: #1C1C1CFF;
  --plugin-table-border-color: #FFFFFF15;
  --plugin-highlight-color: #000000FF;
  --plugin-highlight-background-color: #9184EEFF;
  --plugin-scrollbar-arrow-background-color: #FFFFFF0F;
  --plugin-scrollbar-arrow-background-active-color: #FFFFFF15;
  --plugin-scrollbar-arrow-background-hover-color: #FFFFFF15;
  --plugin-scrollbar-arrow-color: #FFFFFF8B;
  --plugin-scrollbar-arrow-active-color: #FFFFFF8B;
  --plugin-scrollbar-arrow-hover-color: #FFFFFF8B;
  --plugin-scrollbar-background-color: #FFFFFF00;
  --plugin-scrollbar-background-hover-color: #3A3A3A4D;
  --plugin-scrollbar-face-color: #FFFFFF8B;
  --plugin-scrollbar-face-active-color: #FFFFFF8B;
  --plugin-scrollbar-face-hover-color: #FFFFFF8B;
  --plugin-select-option-background-color: #202020FF;
  --plugin-select-option-color: #FFFFFFFF;
  --plugin-select-option-checked-background-color: #9184EEFF;
  --plugin-select-option-checked-border-color: #9184EEFF;
  --plugin-select-option-checked-foreground-color: #000000FF;
  --plugin-select-option-hover-background-color: #FFFFFF0F;
  --plugin-select-option-hover-border-color: #FFFFFF12;
  --plugin-select-option-hover-foreground-color: #FFFFFFFF;
  --plugin-select-border-color: #FFFFFF12;
  --plugin-select-background-color: #FFFFFF0F;
  --plugin-select-foreground-color: #FFFFFFFF;
  --plugin-select-hover-border-color: #FFFFFF12;
  --plugin-select-hover-background-color: #FFFFFF15;
  --plugin-select-hover-foreground-color: #FFFFFFFF;
  --plugin-textbox-border-color: #FFFFFF12;
  --plugin-textbox-background-color: #FFFFFF0F;
  --plugin-textbox-color: #FFFFFFFF;
  --plugin-textbox-disabled-background-color: #FFFFFF0B;
  --plugin-textbox-disabled-border-color: #FFFFFF12;
  --plugin-textbox-disabled-color: #FFFFFF5D;
  --plugin-tooltip-text-color: #FFFFFFFF;
  --plugin-tooltip-background-color: #202020FF;
  --plugin-tooltip-border-color: #0000001A;
  --plugin-treeview-content-inactive-selected-background-color: #FFFFFF0F;
  --plugin-treeview-content-inactive-selected-color: #FFFFFFC8;
  --plugin-treeview-content-selected-background-color: #9184EEFF;
  --plugin-treeview-content-selected-color: #000000FF;
  --plugin-treeview-content-selected-border-color: #9184EEFF;
  --plugin-treeview-content-background-color: #202020FF;
  --plugin-treeview-content-color: #FFFFFFFF;
  --plugin-treeview-content-mouseover-background-color: #FFFFFF0F;
  --plugin-treeview-content-mouseover-color: #FFFFFFFF;
  --plugin-scrollbar-up-arrow-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 5.9989C1.14924 5.9989 0.674785 5.09087 1.13603 4.42784L3.76866 0.64342C4.36545 -0.214452 5.6346 -0.214448 6.23138 0.643422L8.86402 4.42784C9.32526 5.09087 8.8508 5.9989 8.04311 5.9989H1.95693Z' fill='%23FFFFFF8B' /%3E%3C/svg%3E");
  --plugin-scrollbar-up-arrow-active-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 5.9989C1.14924 5.9989 0.674785 5.09087 1.13603 4.42784L3.76866 0.64342C4.36545 -0.214452 5.6346 -0.214448 6.23138 0.643422L8.86402 4.42784C9.32526 5.09087 8.8508 5.9989 8.04311 5.9989H1.95693Z' fill='%23FFFFFFFF' /%3E%3C/svg%3E");
  --plugin-scrollbar-up-arrow-hover-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 5.9989C1.14924 5.9989 0.674785 5.09087 1.13603 4.42784L3.76866 0.64342C4.36545 -0.214452 5.6346 -0.214448 6.23138 0.643422L8.86402 4.42784C9.32526 5.09087 8.8508 5.9989 8.04311 5.9989H1.95693Z' fill='%23FFFFFFFF' /%3E%3C/svg%3E");
  --plugin-scrollbar-down-arrow-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 0C1.14924 0 0.674785 0.90803 1.13603 1.57107L3.76866 5.35548C4.36545 6.21335 5.6346 6.21335 6.23138 5.35548L8.86402 1.57106C9.32526 0.908027 8.8508 0 8.04311 0H1.95693Z' fill='%23FFFFFF8B' /%3E%3C/svg%3E");
  --plugin-scrollbar-down-arrow-active-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 0C1.14924 0 0.674785 0.90803 1.13603 1.57107L3.76866 5.35548C4.36545 6.21335 5.6346 6.21335 6.23138 5.35548L8.86402 1.57106C9.32526 0.908027 8.8508 0 8.04311 0H1.95693Z' fill='%23FFFFFFFF' /%3E%3C/svg%3E");
  --plugin-scrollbar-down-arrow-hover-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1.95693 0C1.14924 0 0.674785 0.90803 1.13603 1.57107L3.76866 5.35548C4.36545 6.21335 5.6346 6.21335 6.23138 5.35548L8.86402 1.57106C9.32526 0.908027 8.8508 0 8.04311 0H1.95693Z' fill='%23FFFFFFFF' /%3E%3C/svg%3E");
  --plugin-scrollbar-left-arrow-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M4.42784 8.8403C5.09087 9.29871 5.9989 8.82717 5.9989 8.02443V1.9756C5.9989 1.17287 5.09087 0.701325 4.42784 1.15974L0.643422 3.77622C-0.214448 4.36933 -0.214452 5.6307 0.64342 6.22382L4.42784 8.8403Z' fill='%23FFFFFF8B' /%3E%3C/svg%3E");
  --plugin-scrollbar-left-arrow-active-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M4.42784 8.8403C5.09087 9.29871 5.9989 8.82717 5.9989 8.02443V1.9756C5.9989 1.17287 5.09087 0.701325 4.42784 1.15974L0.643422 3.77622C-0.214448 4.36933 -0.214452 5.6307 0.64342 6.22382L4.42784 8.8403Z' fill='%23FFFFFFFF' /%3E%3C/svg%3E");
  --plugin-scrollbar-left-arrow-hover-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M4.42784 8.8403C5.09087 9.29871 5.9989 8.82717 5.9989 8.02443V1.9756C5.9989 1.17287 5.09087 0.701325 4.42784 1.15974L0.643422 3.77622C-0.214448 4.36933 -0.214452 5.6307 0.64342 6.22382L4.42784 8.8403Z' fill='%23FFFFFFFF' /%3E%3C/svg%3E");
  --plugin-scrollbar-right-arrow-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M1.57107 8.8403C0.90803 9.29871 0 8.82717 0 8.02443L0 1.9756C0 1.17287 0.908028 0.701325 1.57106 1.15974L5.35548 3.77622C6.21335 4.36933 6.21335 5.6307 5.35548 6.22382L1.57107 8.8403Z' fill='%23FFFFFF8B' /%3E%3C/svg%3E");
  --plugin-scrollbar-right-arrow-active-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M1.57107 8.8403C0.90803 9.29871 0 8.82717 0 8.02443L0 1.9756C0 1.17287 0.908028 0.701325 1.57106 1.15974L5.35548 3.77622C6.21335 4.36933 6.21335 5.6307 5.35548 6.22382L1.57107 8.8403Z' fill='%23FFFFFFFF' /%3E%3C/svg%3E");
  --plugin-scrollbar-right-arrow-hover-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='10' viewBox='0 0 6 10'%3E%3Cpath d='M1.57107 8.8403C0.90803 9.29871 0 8.82717 0 8.02443L0 1.9756C0 1.17287 0.908028 0.701325 1.57106 1.15974L5.35548 3.77622C6.21335 4.36933 6.21335 5.6307 5.35548 6.22382L1.57107 8.8403Z' fill='%23FFFFFFFF' /%3E%3C/svg%3E");
  --plugin-corner-radius-none: 0;
  --plugin-corner-radius-s: 2;
  --plugin-corner-radius-m: 4;
  --plugin-corner-radius-l: 6;
  --plugin-corner-radius-xl: 8;
  --plugin-corner-radius-focus-rect: 6;
  --plugin-spacing-none: 0;
  --plugin-spacing-xxxs: 1;
  --plugin-spacing-xxs: 2;
  --plugin-spacing-xs-nudge: 3;
  --plugin-spacing-xs: 4;
  --plugin-spacing-s-nudge: 6;
  --plugin-spacing-s: 8;
  --plugin-spacing-m-nudge: 10;
  --plugin-spacing-m: 12;
  --plugin-spacing-l: 16;
  --plugin-spacing-xl: 20;
  --plugin-spacing-xxl: 24;
  --plugin-spacing-xxxl: 32;
  --plugin-size-content-min-height: 16;
  --plugin-size-content-min-width: 16;
  --plugin-size-control-min-height: 24;
  --plugin-size-control-min-width: 24;
  --plugin-size-toggle-switch-size: 20;
  --plugin-size-icon-xxs: 8;
  --plugin-size-icon-xs: 12;
  --plugin-size-icon-s: 16;
  --plugin-size-icon-m: 24;
  --plugin-size-icon-l: 32;
  --plugin-size-non-client-control-height: 30;
  --plugin-size-non-client-control-width: 44;
  --plugin-stroke-width-none: 0;
  --plugin-stroke-width-thin: 1;
  --plugin-stroke-width-thick: 2;
  --plugin-stroke-width-thicker: 3;
  --plugin-stroke-width-thickest: 4;
  --plugin-typography-body-line-height: 20;
  --plugin-typography-body-large-line-height: 24;
  --plugin-typography-caption-line-height: 16;
  --plugin-typography-code-line-height: 20;
  --plugin-typography-display-line-height: 92;
  --plugin-typography-subtitle-line-height: 28;
  --plugin-typography-title-line-height: 36;
  --plugin-typography-title-large-line-height: 52;
}

/* CSS file for the plugin's base styles and themes (light / dark / high contrast)
   Light theme values are used as defaults but CSS variables are used to provide the correct value for the active theme.
    Example:
    border-right: 1px solid var(--plugin-background-color, #8591A2);

   The following CSS variables are available to all hosts:
    --plugin-background-color
    --plugin-color
    --plugin-contextmenu-active-color
    --plugin-contextmenu-background-color
    --plugin-contextmenu-border-color
    --plugin-contextmenu-color
    --plugin-contextmenu-hover-color
    --plugin-contextmenu-hover-text-color
    --plugin-contextmenu-icon-checkbox
    --plugin-contextmenu-inactive-text-color
    --plugin-contextmenu-separator-color
    --plugin-error-border-color
    --plugin-font-family
    --plugin-font-size
    --plugin-font-weight
    --plugin-highlight-background-color
    --plugin-highlight-color
    --plugin-inactive-color
    --plugin-link-color
    --plugin-link-active-color
    --plugin-link-hover-color
    --plugin-scrollbar-arrow-background-color
    --plugin-scrollbar-arrow-background-active-color
    --plugin-scrollbar-arrow-background-hover-color
    --plugin-scrollbar-arrow-color
    --plugin-scrollbar-arrow-active-color
    --plugin-scrollbar-arrow-hover-color
    --plugin-scrollbar-background-color
    --plugin-scrollbar-face-color
    --plugin-scrollbar-face-active-color
    --plugin-scrollbar-face-hover-color
    --plugin-select-option-background-color
    --plugin-select-option-color
    --plugin-select-option-checked-background-color
    --plugin-select-option-checked-border-color
    --plugin-select-option-checked-foreground-color
    --plugin-select-option-hover-background-color
    --plugin-select-option-hover-border-color
    --plugin-select-option-hover-foreground-color
    --plugin-select-border-color
    --plugin-select-background-color
    --plugin-select-foreground-color
    --plugin-select-hover-background-color
    --plugin-select-hover-border-color
    --plugin-select-hover-foreground-color
    --plugin-table-border-color
    --plugin-table-header-background-color
    --plugin-table-header-color
    --plugin-textbox-border-color
    --plugin-textbox-background-color
    --plugin-textbox-color
    --plugin-textbox-disabled-background-color
    --plugin-textbox-disabled-border-color
    --plugin-textbox-disabled-color
    --plugin-treeview-content-background-color
    --plugin-treeview-content-color
    --plugin-treeview-content-inactive-selected-color
    --plugin-treeview-content-mouseover-background-color
    --plugin-treeview-content-mouseover-color
    --plugin-treeview-content-inactive-selected-color
    --plugin-treeview-content-selected-background-color
    --plugin-treeview-content-selected-border-color
    --plugin-treeview-content-selected-color

    The following are special values used just for theming scrollbar arrows (they contain a data URL defining an SVG):
    --plugin-scrollbar-up-arrow-url
    --plugin-scrollbar-up-arrow-hover-url
    --plugin-scrollbar-up-arrow-active-url
    --plugin-scrollbar-down-arrow-url
    --plugin-scrollbar-down-arrow-hover-url
    --plugin-scrollbar-down-arrow-active-url
    --plugin-scrollbar-left-arrow-url
    --plugin-scrollbar-left-arrow-hover-url
    --plugin-scrollbar-left-arrow-active-url
    --plugin-scrollbar-right-arrow-url
    --plugin-scrollbar-right-arrow-hover-url
    --plugin-scrollbar-right-arrow-active-url


    VS host also has access to all VS themed color key tokens (EnvironmentColors) and category specific tokens.
    http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.platformui.environmentcolors_properties
    Please see product documentation for instructions on how to add these tokens to the plugin manifest.
 */

/* HTML and body styles */
html, body {
    font-family: var(--plugin-font-family, "Segoe UI", Arial, sans-serif);
    font-size: var(--plugin-font-size, 9pt);
    font-weight: var(--plugin-font-weight, normal);
    color: var(--plugin-color, #1E1E1E);
    background-color: var(--plugin-background-color, #F6F6F6);
}

/* Scroll bars */

::-webkit-scrollbar {
    width: 18px;
    height: 18px;
    background-color: transparent;
}

/* Hover over the scrollbar */
::-webkit-scrollbar:hover {
    background-color: var(--plugin-scrollbar-background-hover-color, #C8C8C833) /* track hover color */
}

::-webkit-scrollbar-corner {
    background-color: transparent;
}

::-webkit-scrollbar:hover::-webkit-scrollbar-corner {
    background-color: var(--plugin-scrollbar-background-hover-color, #C8C8C833) /* match track hover */
}

/* Track */
::-webkit-scrollbar-track {
    background: transparent;
}

/* Thumb */
::-webkit-scrollbar-thumb {
    background-color: var(--plugin-scrollbar-face-color, #6E6E6E);
    border: 8px solid transparent; /* make the thumb appears smaller */
    background-clip: padding-box;
    border-radius: 9px; /* half of the thickness */
}

::-webkit-scrollbar-thumb:hover {
    border: 5px solid transparent; /* make the thumb appears larger */
}

/* Arrows */

::-webkit-scrollbar-button {
    background-color: transparent;
    background-repeat: no-repeat;
    background-position: center;
}

/* Up arrow */

::-webkit-scrollbar-button:start:decrement:vertical {
    background-image: var(--plugin-scrollbar-up-arrow-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:start:decrement:vertical:hover {
    background-image: var(--plugin-scrollbar-up-arrow-hover-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:start:decrement:vertical:active {
    background-image: var(--plugin-scrollbar-up-arrow-active-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

/* Down arrow */

::-webkit-scrollbar-button:end:increment:vertical {
    background-image: var(--plugin-scrollbar-down-arrow-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:end:increment:vertical:hover {
    background-image: var(--plugin-scrollbar-down-arrow-hover-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:end:increment:vertical:active {
    background-image: var(--plugin-scrollbar-down-arrow-active-url);
    background-size: 10px 6px;  /* match the SVG intrinsic size */
}

/* Left arrow */

::-webkit-scrollbar-button:start:decrement:horizontal {
    background-image: var(--plugin-scrollbar-left-arrow-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:start:decrement:horizontal:hover {
    background-image: var(--plugin-scrollbar-left-arrow-hover-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:start:decrement:horizontal:active {
    background-image: var(--plugin-scrollbar-left-arrow-active-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

/* Right arrow */

::-webkit-scrollbar-button:end:increment:horizontal {
    background-image: var(--plugin-scrollbar-right-arrow-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:end:increment:horizontal:hover {
    background-image: var(--plugin-scrollbar-right-arrow-hover-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

::-webkit-scrollbar-button:end:increment:horizontal:active {
    background-image: var(--plugin-scrollbar-right-arrow-active-url);
    background-size: 6px 10px;  /* match the SVG intrinsic size */
}

/* Select styles */
select {
    color: var(--plugin-select-foreground-color, #1E1E1E);
    background-color: var(--plugin-select-background-color, #FFFFFF);
    font: var(--plugin-font-weight, normal) var(--plugin-font-size, 9pt) var(--plugin-font-family, "'Segoe UI', Arial, sans-serif");
    border: 1px solid var(--plugin-select-border-color, #CCCEDB);
}

select:hover {
    color: var(--plugin-select-hover-foreground-color, #1E1E1E);
    background-color: var(--plugin-select-hover-background-color, #FFFFFF);
    border: 1px solid var(--plugin-select-hover-border-color, #007ACC);
}

select[multiple],
select option {
    color: var(--plugin-select-option-color, #1E1E1E);
    background-color: var(--plugin-select-option-background-color, #F6F6F6);
    /* Add a transparent border so that text does not move around on hover */
    border: 1px solid transparent;
}

select option:hover {
    color: var(--plugin-select-option-hover-foreground-color, #1E1E1E);
    background-color: var(--plugin-select-option-hover-background-color, #C9DEF5);
    border: 1px solid var(--plugin-select-option-hover-border-color, #C9DEF5);
}

select option:checked {
    color: var(--plugin-select-option-checked-foreground-color, #1E1E1E);
    background-color: var(--plugin-select-option-checked-background-color, #C9DEF5);
    border: 1px solid var(--plugin-select-option-checked-border-color, #C9DEF5);
}

/* Input styles */
input {
    font: var(--plugin-font-weight, normal) var(--plugin-font-size, 9pt) var(--plugin-font-family, "'Segoe UI', Arial, sans-serif");
    color: var(--plugin-textbox-color, #1E1E1E);
    background-color: var(--plugin-textbox-background-color, #FFFFFF);
    border: 1px solid var(--plugin-textbox-border-color, #DBDDE6);
    padding: 0 3px;
}

input:disabled {
    color: var(--plugin-textbox-disabled-color, #A2A4A5);
    background-color: var(--plugin-textbox-disabled-background-color, #FFFFFF);
    border: 1px solid var(--plugin-textbox-disabled-border-color, #DBDDE6);
}

input[type="checkbox"],
input[type="radio"]
 {
    border: none;
    background-color: inherit;
    margin-right: 4px;
    vertical-align: middle;
}

input[type="file"],
input[type="image"]
 {
    border: none;
    background-color: inherit;
    padding: 0;
}

/* TextArea styles */
textarea {
    font-family: var(--plugin-font-family, "Segoe UI"), Arial, sans-serif;
    font-size: var(--plugin-font-size, 9pt);
    font-weight: var(--plugin-font-weight, normal);
    color: var(--plugin-color, #1E1E1E);
    background-color: var(--plugin-textbox-background-color, #F6F6F6);
    border: 1px solid var(--plugin-textbox-border-color, #DBDDE6);
    padding: 0 3px;
    resize: none;
}

/* Button styles */
button,
input[type="button"],
input[type="reset"],
input[type="submit"] {
    color: #000000;
    background-image: -ms-linear-gradient(top, #F0F0F0 0%, #E5E5E5 100%);
    border: 1px solid #ACACAC;
    font-family: var(--plugin-font-family, "Segoe UI"), Arial, sans-serif;
    font-size: var(--plugin-font-size, 9pt);
    font-weight: var(--plugin-font-weight, normal);
    min-width: 73px;
    padding: 1px 19px 2px 19px;
}

button:hover,
input[type="button"]:hover,
input[type="reset"]:hover,
input[type="submit"]:hover {
    background-image: -ms-linear-gradient(top, #ECF4FC 0%, #DCECFC 100%);
    border: 1px solid #7EB4EA;
}

button:focus,
input[type="button"]:focus,
input[type="reset"]:focus,
input[type="submit"]:focus {
    border: 1px solid #569DE5;
}

button:active,
input[type="button"]:active,
input[type="reset"]:active,
input[type="submit"]:active {
    background-image: -ms-linear-gradient(top, #DAECFC 0%, #C4E0FC 100%);
    border: 1px solid #569DE5;
}

button[disabled],
input[type="button"][disabled],
input[type="reset"][disabled],
input[type="submit"][disabled] {
    color: #838383;
    background: #F4F4F4 none;
    border: 1px solid #B1B1B2;
}

/* Other form styles */
fieldset {
    border: 1px solid var(--plugin-textbox-border-color, #DBDDE6);
}

/* Link styles */
a, a:link, a:visited, a:focus {
    color: var(--plugin-link-color, #0E70C0);
    text-decoration: none;
}

a:hover {
    color: var(--plugin-link-hover-color, #0E70C0);
    text-decoration: underline;
}

a:active {
    color: var(--plugin-link-active-color, #0E70C0);
}

/* Table styles */
th {
    color: var(--plugin-table-header-color, #1E1E1E);
    background-color: var(--plugin-table-header-background-color, #EFEFE2);
}

td, th {
    border-color: var(--plugin-table-border-color, #F0F0F0);
}

/* Disabled styles */
:disabled {
    color: var(--plugin-inactive-color, #A2A4A5);
}

/* Highlight styles
   Use this class when you have a highlighted item, for example a highlighted row in a grid */
.plugin-highlight {
    color: var(--plugin-highlight-color, #FFFFFF);
    background-color: var(--plugin-highlight-background-color, #3399FF);
}

/* Tooltip styles
   This class will be included automatically on all tooltips
   In VS tooltips aren't, by default, themed, so we just copy
   the WPF tooltip defaults, which is what VS uses for its tooltips.
   The one exception is that under system high-contrast themes tooltips
   are in fact themed, so we use the !HCOnly to indicate we only want
   our color tokens substituted under high-contrast themes.

   We set its initial display style to none and its initial position
   to (-500,-500) just to ensure that when we insert it into the document
   (for measuring) it isn't visible until we have done the layout and
   calculated its final position.
*/
#plugin-vs-tooltip {
    display: none;
    position: absolute;
    top: -500px;
    left: -500px;
    -ms-high-contrast-adjust: none;
    color: var(--plugin-tooltip-text-color, #575757);
    background-color: var(--plugin-tooltip-background-color, #F1F2F7);
    border: thin solid var(--plugin-tooltip-border-color, #767676);
    padding: 4px 5px 3px 5px;
    line-height: normal;
    box-sizing: border-box;
}

#plugin-vs-tooltip > #plugin-vs-tooltip-nested-cell {
    display: table-cell;
    vertical-align: middle;
    -ms-high-contrast-adjust: none;
    color: var(--plugin-tooltip-text-color, #575757);
    background-color: var(--plugin-tooltip-background-color, #F1F2F7);
}

#plugin-vs-tooltip > #plugin-vs-tooltip-nested-cell > #plugin-vs-tooltip-content {
    -ms-high-contrast-adjust: none;
    color: var(--plugin-tooltip-text-color, #575757);
    background-color: var(--plugin-tooltip-background-color, #F1F2F7);
}

/* Selection styles */
.selectNone {
    -ms-user-select: none;
    user-select: none;
}

.selectElement {
    -ms-user-select: element;
    user-select: auto;
}

/* Context Menu styles */
ul.plugin-contextmenu {
    background-color: var(--plugin-contextmenu-background-color, #e9e8ea);
    border: thin solid var(--plugin-contextmenu-border-color, #cdd0d6);
    color: var(--plugin-contextmenu-color, #1E1E1E);
    padding: 1px 2px 2px 2px;
    margin: 0;
    position: absolute;
    display: none;
    outline: none;
    z-index: 100;
    white-space: nowrap;
    -ms-high-contrast-adjust: none;
    line-height: normal;
}

.plugin-contextmenu .menuitem {
    display: flex;
    align-items: center;
    /* VS context menu max width: https://devdiv.visualstudio.com/DevDiv/_git/VS?path=/src/env/shell/UIInternal/MainWindow/Controls/VsMenuItem.cs&version=GBmain&line=85&lineEnd=92&lineStartColumn=9&lineEndColumn=10&lineStyle=plain&_a=contents */
    max-width: 660px;
    cursor: default;
    outline: none;
    list-style: none;
    margin-top: 1px;
    border: 1px solid transparent;
    box-sizing: border-box;
}

.plugin-contextmenu .menuitem:focus {
    background-color: var(--plugin-contextmenu-hover-color, #f9f9fa);
    color: var(--plugin-contextmenu-hover-text-color, #1E1E1E);
    border-color: var(--plugin-contextmenu-hover-border-color);
}

.plugin-contextmenu .menuitem:active,
.plugin-contextmenu .active {
    background-color: var(--plugin-contextmenu-active-color, #f9f9fa);
    color: var(--plugin-contextmenu-hover-text-color, #1E1E1E);
    border-color: var(--plugin-highlight-background-color);
}

.plugin-contextmenu .disabled:hover,
.plugin-contextmenu .disabled:active,
.plugin-contextmenu .disabled:focus,
.plugin-contextmenu .disabled {
    background-color: var(--plugin-contextmenu-background-color, #e9e8ea);
    color: var(--plugin-contextmenu-inactive-text-color, #a2a4a5);
}

.plugin-contextmenu .menuitem .icon {
    margin: 0 10px 0 6px;
    background-color: transparent;
    width: 16px;
    height: 16px;
}

.plugin-contextmenu .menuitem .checkbox {
    background-image: var(--plugin-contextmenu-icon-checkbox, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/PbtGwMpgAWIfXx8iFS9ZcsWJgYSAQuctW7tejzqgoIDIQx8Nrx69QqobvKUyciC+DSsXLUSSIaHhROlAWj8/v37HB2dxMTEiNKA1Xh0DR2dHUBHvwIDrMajhBIQJCUmnTp1EmI2VuPRNQDNA5oKNBvIxmo8Fj/ATcVqPLoNEEvwxyALZlziBySnJUZSkzdAgAEAfm84vuieuk0AAAAASUVORK5CYII=));
}

.plugin-contextmenu .hidden {
    display: none;
}

.plugin-contextmenu .disabled {
    color: var(--plugin-contextmenu-inactive-text-color, #a2a4a5);
}

.plugin-contextmenu .menuitem .main {
    padding: 4px 50px 5px 0;
    margin-right: auto;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
}

.plugin-contextmenu .menuitem .shortcut {
    min-width: 25px;
    flex-shrink: 0;
    padding-right: 25px;
}

.plugin-contextmenu .menuitem .arrow {
    overflow: visible;
}

.plugin-contextmenu .menuitem .arrow:before,
.plugin-contextmenu .menuitem.disabled:hover .arrow:before,
.plugin-contextmenu .menuitem.disabled:active .arrow:before,
.plugin-contextmenu .menuitem.disabled:focus .arrow:before,
.plugin-contextmenu .menuitem.disabled .arrow:before {
    content: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAHCAYAAADAp4fuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNpiWL5i5X8gYEDGTKdOnmCYOXP2fwYkwAQibt68ztDXP+E/iiAIPHn8iGHChIn/UQSFhIQZCgryGUFsFhAhIyvHUFRYwAg3dMaMWRi2AwQYAAcRMJwq3CX+AAAAAElFTkSuQmCC);
}

.plugin-contextmenu .menuitem:hover .arrow:before,
.plugin-contextmenu .menuitem:active .arrow:before,
.plugin-contextmenu .menuitem:focus .arrow:before,
.plugin-contextmenu .active .arrow:before {
    content: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAHCAYAAADAp4fuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFRJREFUeNpiKNzy6D8QMCBjBoaqM/+DltxGkWACCjOsu/aRwXrmDZASMGCCMY49+spgP/vmfxRBdRF2hoOp6oxwQSs5boYbhTqMMAUM6JaAMECAAQDqqjmrw1gHVwAAAABJRU5ErkJggg==);
}

.plugin-contextmenu .menuitem[role="separator"] > * {
    height: 0;
}

.plugin-contextmenu .menuitem .hr,
.plugin-contextmenu .menuitem:hover .hr,
.plugin-contextmenu .menuitem:active .hr,
.plugin-contextmenu .menuitem:focus .hr,
.plugin-contextmenu .active .hr {
    height: 1px;
    width: 100%;
    background-color: var(--plugin-contextmenu-separator-color, #cdd0d6);
    padding: 0;
}
</style>
    <script src="http://scriptedhost.vs/plugin.js" type="text/javascript" class="selectNone"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" class="selectNone">
    <meta charset="utf-8" class="selectNone">
    <link rel="stylesheet" href="c:\program files\microsoft visual studio\18\insiders\common7\ide\commonextensions\microsoft\markdown\Preview\Dependencies\daytona-highlight-dark.css" id="CSSTheme" class="selectNone">
    <link rel="stylesheet" href=" " id="FontSize" class="selectNone">
    <script type="text/javascript" src="./DOMPurify/purify.min.js" id="DomPurifyTag" class="selectNone"></script>
    <script type="text/javascript" src="./daytonaHtmlContextMenu.js" id="HTMLContextMenuScript" class="selectNone"></script>
    <script type="text/javascript" src="./mermaidJS/mermaid.min.js" class="selectNone"></script>
    <style class="selectNone">
        html, body {
        }
    </style>
    <title class="selectNone">Markdown Preview</title>
    <meta http-equiv="cache-control" content="no-cache" class="selectNone">
<base href="file://C:/D/Work/Training/OOD/AppInfra-repo/.Practice/readme.md"><base><base><base></head>
<body class="selectNone">
    <div id="___markdown-content___" class="selectNone" data-plugin-contextmenu="plugin-contextmenu-99ef447c-a946-f210-fc20-99f87cff3879"><h1 id="this-file-contains-exercises-based-on-the-appinfra-demo"><a id="pragma-line-0"></a>This file contains exercises based on the AppInfra demo</h1>
<h2 id="notifications-module"><a id="pragma-line-2"></a>0. Notifications Module</h2>
<blockquote id="pragma-line-4">
<p id="pragma-line-4"><strong>!Objective</strong>: Get familiar with the DemoApp, and see how the Bootstrapper, the Application Initialization, Dependency Injection and Service Locator work</p>
</blockquote>
<h4 id="explore-the-appinfrademo-solution"><a id="pragma-line-6"></a>0.1 Explore the AppInfraDemo solution</h4>
<ul id="pragma-line-7">
<li id="pragma-line-7">Look at the <code>ConsoleUi</code> project. It is the host process</li>
<li id="pragma-line-8">Loot at the <code>AppBoot</code> folder. It contains the Bootstrapper and the initialization logic</li>
<li id="pragma-line-9">Look at the <code>Contracts</code> folder. It contains the contracts for the services exposed by the modules</li>
</ul>
<h4 id="notifications-serivces"><a id="pragma-line-11"></a>0.2 Notifications Serivces</h4>
<ul id="pragma-line-12">
<li id="pragma-line-12"><p id="pragma-line-12">Explore the <code>Notification.Services</code> project</p>
<ul id="pragma-line-13">
<li id="pragma-line-13"><code>NotificationService</code> is used to send notifications</li>
<li id="pragma-line-14"><code>StateChangeSubscriber</code> shows how a subscriber may be implemented</li>
<li id="pragma-line-15">The <code>ConsoleUi</code> implements  the <code>IAmAliveSubscriber&lt;IModule&gt;</code> to write a console when a new module is alive</li>
</ul>
</li>
<li id="pragma-line-17"><p id="pragma-line-17">Understand how "NotificationsModule is alive!" appears on the console during the application boot.</p>
</li>
</ul>
<hr id="pragma-line-19">
<h2 id="sales-module"><a id="pragma-line-21"></a>1. Sales Module</h2>
<h3 id="advanced-add-sales-module-and-sales.services-project-to-solution"><a id="pragma-line-23"></a>1.0 [Advanced] Add Sales Module and Sales.Services project to solution</h3>
<blockquote id="pragma-line-25">
<p id="pragma-line-25">This exercise is optional. To do it you need to go back in history and checkuout <code>practice-1.0</code> tag</p>
</blockquote>
<p id="pragma-line-27">Do the following steps:</p>
<ul id="pragma-line-28">
<li id="pragma-line-28">Create the <code>Modules\Sales</code> solution folder and the correspondent <code>.\Modules\Sales</code> folder in the source tree
<ul id="pragma-line-29">
<li id="pragma-line-29">! the naming conventions and folder structure matters !</li>
</ul>
</li>
<li id="pragma-line-30">Add the <code>Sales.Services</code> project to the solution in this create folder.</li>
<li id="pragma-line-31">Understand how an application with plugins works in .NET (see <a href="https://learn.microsoft.com/en-us/dotnet/core/tutorials/creating-app-with-plugin-support">https://learn.microsoft.com/en-us/dotnet/core/tutorials/creating-app-with-plugin-support</a>)
<ul id="pragma-line-32">
<li id="pragma-line-32">add <code>&lt;EnableDynamicLoading&gt;true&lt;/EnableDynamicLoading&gt;</code> to the <code>Sales.Services.csproj</code> file (see <code>Notifications.Services.csproj</code> for reference)</li>
<li id="pragma-line-33">Understand how <code>AppBoot</code> loads plugins
<ul id="pragma-line-34">
<li id="pragma-line-34">look at <code>AppBoot.AssemblyLoad</code> namespace</li>
<li id="pragma-line-35">look at <code>BreadcrumbNameConventionPathBuilder</code> and <code>PluginAssemblyLoader</code> classes to understand why the naming and folders conventions matter.</li>
</ul>
</li>
</ul>
</li>
<li id="pragma-line-36">Setup <code>Sales.Services</code> as a solution dependency of <code>ConsoleUi</code> (this is needed so it builds when <code>ConsoleUi</code> is build for debug (on F5))</li>
<li id="pragma-line-37">Configure <code>Sales.Services</code> plugin in AppBoot
<ul id="pragma-line-38">
<li id="pragma-line-38">in <code>ConsoleUi/Program.cs</code> in AppBoot setup:
<ul id="pragma-line-39">
<li id="pragma-line-39">make sure the NameFilter allows for <code>Sales.*.</code> assemblies</li>
<li id="pragma-line-40">add <code>.AddPlugin("Sales.Services")</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="sales-services-module"><a id="pragma-line-42"></a>1.1 Sales Services Module</h4>
<p id="pragma-line-44">Add a <code>SalesServicesModule : IModule</code> and notify when it is alive.</p>
<p id="pragma-line-46">As a model for this, look on how <code>NotificationsModule</code> is implemented and how its <em>I'm Alive</em> notification is shown in the <code>ConsoleApplication</code>.</p>
<h4 id="change-the-order-in-which-the-modules-are-initialized-in-a-loosely-coupled-way"><a id="pragma-line-48"></a>1.2. Change the order in which the modules are initialized in a loosely coupled way</h4>
<p id="pragma-line-50">Use the <code>PriorityAttribute</code> and the <code>OrderByPriority&lt;T&gt;()</code> helper method, from <code>AppBoot.SystemEx.Priority</code></p>
<hr id="pragma-line-52">
<h2 id="console-application"><a id="pragma-line-54"></a>2. Console Application</h2>
<blockquote id="pragma-line-56">
<p id="pragma-line-56"><strong>!Objective</strong>: Understand AppBoot basics: Modules, Dependency Injection, and Service Locator</p>
</blockquote>
<h3 id="transform-the-ordersconsoleapplication-into-an-imodule"><a id="pragma-line-58"></a>2.1. Transform the OrdersConsoleApplication into an IModule</h3>
<p id="pragma-line-60">Make this class to implement the <code>IModule</code>.</p>
<ul id="pragma-line-61">
<li id="pragma-line-61">You should also consider to rename it, so its name reflects that it is a module</li>
<li id="pragma-line-62">The <code>Program.Main()</code> should no longer directly depend on it. With this refactor, on the <code>IModule.Initialize()</code> the menu should be shown.</li>
</ul>
<h3 id="optional-unit-test-the-init-function-of-the-resulted-module"><a id="pragma-line-64"></a>2.2. [Optional] Unit Test the <code>Init()</code> function of the resulted Module</h3>
<p id="pragma-line-66">Which is the external dependencies?
When do we use stubs and when mocks?</p>
<hr id="pragma-line-69">
<h2 id="create-a-composite-console-application"><a id="pragma-line-71"></a>3. Create a Composite Console Application</h2>
<blockquote id="pragma-line-73">
<p id="pragma-line-73"><strong>!Objective</strong>: Understand how to benefit from the AppBoot type discovery and loosely coupled modules</p>
</blockquote>
<h3 id="create-a-console-ui-module-that-discovers-commands-and-builds-a-menu-from-them"><a id="pragma-line-75"></a>3.1. Create a Console Ui Module that discovers commands and builds a menu from them</h3>
<p id="pragma-line-77">Follow the following steps as guidance:</p>
<ol id="pragma-line-79">
<li id="pragma-line-79">Create the <code>IConsoleCommand</code> interface as below:</li>
</ol>
<pre><code id="pragma-line-81">public interface IConsoleCommand
{
    void Execute();
    string MenuLabel { get; }
}
</code></pre>
<ol id="pragma-line-89" start="2">
<li id="pragma-line-89"><p id="pragma-line-89">Create the <code>ConsoleUiModule</code> class that implements <code>IModule</code>. It would discover all the <code>IConsoleCommand</code> implementations, and will build a menu with them on its <code>Initialize()</code> function.</p>
</li>
<li id="pragma-line-92"><p id="pragma-line-92">Transform the OrdersConsoleApplication, in a <code>IConsoleCommand</code> implementation</p>
</li>
</ol>
<p id="pragma-line-95">This should allow any other functional module to provide <code>IConsoleCommand</code> implementations. The <code>ConsoleUiModule</code> will discover them and will present them to the user for execution. It results a loosely coupling between the modules and their UI commands</p>
<h3 id="update-the-solution-structure-in-such-way-that-each-module-may-have-its-own-console-commands-and-it-does-not-depend-on-the-host-process-or-the-ui-app"><a id="pragma-line-97"></a>3.2. Update the solution structure in such way that each module may have its own Console Commands and it does not depend on the host process or the UI app</h3>
<p id="pragma-line-99">Now, the <code>OrdersConsoleCommand</code> resulted from transforming the <code>OrdersConsoleApplication</code> into a <code>IConsoleCommand</code> sits in the <code>ConsoleApplication</code>, but it is quite intimate with the <em>Sales</em> module</p>
<p id="pragma-line-101">We could move it to a new project into the <em>Sales</em> module folder structure, and the new <code>CompositeConsoleUiModule</code> should discover it and use it.</p>
<p id="pragma-line-103">The resulted <code>CompositeConsoleUiModule</code> should not take a dependency on <code>Sales.Services</code> (as we don't want to depend on implementation details, but it would depend on <code>Contracts</code> as it needs the <code>IConsoleCommand</code> interface)</p>
<p id="pragma-line-105"><em>Hints:</em></p>
<ol id="pragma-line-106">
<li id="pragma-line-106">the project should be a class library. It can be deployed on any .NET process</li>
<li id="pragma-line-107">the project should be loaded as a plugin in a similar way with the <code>Sales.Services</code></li>
</ol>
<p id="pragma-line-109">The assemblies from any module (including <em>Sales</em>) should not depend on the <code>ConsoleUi</code> assembly which is the host process and the UI. The dependency should be the other way around. We should invert it by moving the <code>IConsoleCommand</code> and the <code>IConsole</code> to the <code>Contracts</code> assembly  into a new <code>ConsoleUi</code> folder.</p>
<blockquote id="pragma-line-111">
<p id="pragma-line-111">!Observation:
By doing this we are decoupling the application from its UI. All the <code>ConsoleCommand</code> could be displayed and executed from another host or UI, may that be an WPF app or a Web App.</p>
</blockquote>
<blockquote id="pragma-line-114">
<p id="pragma-line-114">!Observation:
Look at the references by generating the <em>Project Dependency Diagram</em></p>
</blockquote>
<h3 id="order-the-menu-entries"><a id="pragma-line-118"></a>3.3. Order the Menu entries</h3>
<ol id="pragma-line-120" type="a">
<li id="pragma-line-120">in a declarative manner</li>
<li id="pragma-line-121">by module and then by more entries in the same module</li>
</ol>
<hr id="pragma-line-123">
<h2 id="customer-orders-service"><a id="pragma-line-126"></a>4. Customer Orders Service</h2>
<blockquote id="pragma-line-128">
<p id="pragma-line-128">!Objective: Understand DataAccess implementation</p>
</blockquote>
<p id="pragma-line-130">All below should be called through a simple UI like the Console UI built in previous exercises</p>
<h3 id="create-a-new-service-in-the-sales-module-that-returns-all-the-customers-which-have-orders-ordered-by-store-name"><a id="pragma-line-132"></a>4.1. Create a new service in the Sales module that returns all the customers which have orders, ordered by store name</h3>
<p id="pragma-line-134">[Optional] - Write unit tests for it. Include tests that verify if the OrderBy is applied.</p>
<p id="pragma-line-136"><em>Hint (linq query):</em></p>
<pre><code id="pragma-line-137">Customers
	 .Where(c =&gt; c.SalesOrderHeaders.Any())
            .OrderBy(c =&gt; c.CompanyName)
            .Select(c =&gt; new CustomerData
            {
                Id = c.CustomerID,
                CompanyName = c.CompanyName,
                SalesPerson = c.SalesPerson
            });
</code></pre>
<h3 id="optional-add-more-filters-and-understand-how-you-could-unit-test-those-laveraging-the-irepository-interface-testability"><a id="pragma-line-149"></a>4.2. [Optional] Add more filters and understand how you could unit test those laveraging the IRepository interface testability</h3>
<ul id="pragma-line-151">
<li id="pragma-line-151">Show only the customers that have the name starting with a string which was read from the console.</li>
<li id="pragma-line-152">Show only the customers that have in the name a string which was read from the console</li>
<li id="pragma-line-153">Write Unit Tests for the above</li>
</ul>
<h3 id="create-a-console-command-that-sets-the-status-of-all-orders-of-a-customer"><a id="pragma-line-155"></a>4.3. Create a console command that sets the status of all orders of a customer</h3>
<ul id="pragma-line-157">
<li id="pragma-line-157">Create a new operation in the <code>OrderingService</code> that sets the status of all orders of a customer</li>
<li id="pragma-line-158">We should read some relevant info about the customer that we will use to find the orders to which we will change the status</li>
<li id="pragma-line-159">The new status should be read from the console OR hardcoded</li>
</ul>
<p id="pragma-line-161"><em>See the <code>SalesOrderHeaderStatusValues</code> class for the values of the <code>SalesOrderHeader.Status</code> property</em></p>
<hr id="pragma-line-163">
<h2 id="dataaccess.entityinterceptors"><a id="pragma-line-165"></a>5. DataAccess.EntityInterceptors</h2>
<blockquote id="pragma-line-167">
<p id="pragma-line-167">!Objective: Understand and use EntityInterceptors</p>
</blockquote>
<p id="pragma-line-169">Use <code>EntityInterceptors</code> and <code>INotificationService</code> to implement:</p>
<h3 id="implement-a-istatechangesubscribersalesorderheader-that-shows-on-the-console-when-a-salesorderheader-is-created-deleted-or-changed"><a id="pragma-line-171"></a>5.1. Implement a <code>IStateChangeSubscriber&lt;SalesOrderHeader&gt;</code> that shows on the console when a <code>SalesOrderHeader</code> is created, deleted or changed</h3>
<p id="pragma-line-173"><em>Hint:</em> This should be part of the Sales Module</p>
<h3 id="implement-a-default-istatechangesubscribert-that-writes-in-a-text-file-when-any-dto-is-created-deleted-or-changed"><a id="pragma-line-175"></a>5.2 Implement a default <code>IStateChangeSubscriber&lt;T&gt;</code> that writes in a text file when any DTO is created, deleted or changed</h3>
<p id="pragma-line-177"><em>Hint:</em> This should be part of the Notifications Module</p>
<blockquote id="pragma-line-179">
<p id="pragma-line-179">!Observe and discuss the differences of who triggers the notification</p>
</blockquote>
<hr id="pragma-line-181">
<h2 id="add-entity-auditing"><a id="pragma-line-183"></a>6. Add Entity Auditing</h2>
<blockquote id="pragma-line-185">
<p id="pragma-line-185">!Objective: Understand the DataAccess benefit of low costs when adding new features</p>
</blockquote>
<h3 id="we-want-to-consistently-set-the-modifieddate-for-all-entities-that-have-this-column"><a id="pragma-line-187"></a>6.1. We want to consistently set the <code>ModifiedDate</code> for all entities that have this column</h3>
<ul id="pragma-line-189">
<li id="pragma-line-189">Now, when we modify the order in exercise 4.3 or we add persons in exercise 7 the <code>ModifiedDate</code> is not set.</li>
<li id="pragma-line-190">One way would be to go in all use cases where these entities are modified / created and set the <code>ModifiedDate</code> as well. This would be cumbersome and error prone</li>
<li id="pragma-line-191">We should leverage the advantage of the encapsulated Data Access and extend the infrastructure, with an interceptor that does this for all entities.</li>
</ul>
<p id="pragma-line-193">The interface which should be implemented by the Data Model entities could look like:</p>
<pre><code id="pragma-line-195">interface IAuditable
{
    DateTime ModifiedDate {get;set;}
}
</code></pre>
<hr id="pragma-line-202">
<h2 id="products-management-module"><a id="pragma-line-204"></a>7. Products Management Module</h2>
<h3 id="add-a-new-module-productsmanagementmodule"><a id="pragma-line-206"></a>7.0 Add a new Module <code>ProductsManagementModule</code></h3>
<blockquote id="pragma-line-207">
<p id="pragma-line-207">!Objective: Understand how to add new modules to this Application Infrastructure</p>
</blockquote>
<ul id="pragma-line-209">
<li id="pragma-line-209">Create a new module <code>ProductsManagementModule</code> in the <code>Modules\ProductsManagement</code> folder</li>
<li id="pragma-line-210">Create a new project <code>ProductsManagement.Services</code> in this folder</li>
<li id="pragma-line-211">Create the <code>ProductsManagementModule : IModule</code> class that notifies when it is alive</li>
<li id="pragma-line-212">Add the <code>ProductsManagement.Services</code> as a plugin in the AppBoot</li>
<li id="pragma-line-213">Create the <code>Products.DataModel</code> project in the <code>Modules\ProductsManagement</code> folder
<ul id="pragma-line-214">
<li id="pragma-line-214">Map only the product related properties (e.g. <code>Product</code>, <code>ProductCategory</code>, <code>ProductModel</code> entities)</li>
</ul>
</li>
<li id="pragma-line-215">Create the <code>Products.DbContext</code> project in the <code>Modules\ProductsManagement</code> folder
<ul id="pragma-line-216">
<li id="pragma-line-216">Implement the <code>IDbContextFactory</code> to provide the <code>DbContext</code> for the <code>Products.DataModel</code></li>
</ul>
</li>
</ul>
<h3 id="add-a-new-productcategory"><a id="pragma-line-218"></a>7.1. Add a new <code>ProductCategory</code></h3>
<blockquote id="pragma-line-220">
<p id="pragma-line-220">!Objective: See how existent Application Infrastructure capabilities are used by new features of new Modules</p>
</blockquote>
<h3 id="create-support-to-read-a-entity-from-the-console"><a id="pragma-line-222"></a>7.1.1. Create support to read a entity from the console</h3>
<p id="pragma-line-224">Use the following interfaces:</p>
<pre><code id="pragma-line-226">interface IEntityReader
{
    IEntityFieldsReader&lt;T&gt; BeginEntityRead&lt;T&gt;();
}

interface IEntityFieldsReader&lt;T&gt;
{
    IEnumerable&lt;string&gt; GetFields();
    void SetFieldValue(string value);
    T GetEntity();
}
</code></pre>
<p id="pragma-line-240">Read the data needed to create a <code>ProductCategory</code> entity</p>
<h3 id="create-a-service-that-adds-a-new-productcategory-to-the-system"><a id="pragma-line-242"></a>7.1.2. Create a service that adds a new <code>ProductCategory</code> to the system</h3>
<p id="pragma-line-244">The above console command which reads the product category info should use this service to add the new read product category.</p>
<blockquote id="pragma-line-246">
<p id="pragma-line-246">!Observe: how the interceptors created in ex. 5 &amp; 6 are working when a new ProductCategory is added</p>
</blockquote>
<hr id="pragma-line-248">
<h2 id="persons-managemnt-module"><a id="pragma-line-250"></a>8. Persons Managemnt Module</h2>
<h3 id="add-a-new-module-personsmanagementmodule"><a id="pragma-line-252"></a>8.0 Add a new Module <code>PersonsManagementModule</code></h3>
<blockquote id="pragma-line-254">
<p id="pragma-line-254">!Objectives:</p>
<ol id="pragma-line-255">
<li id="pragma-line-255">Understand how to add new modules to this Application Infrastructure</li>
</ol>
</blockquote>
<ol id="pragma-line-256">
<li id="pragma-line-256">Add new table to the database</li>
<li id="pragma-line-257">Use services from one module into other</li>
</ol>
<ul id="pragma-line-259">
<li id="pragma-line-259">Create a new module <code>PersonsManagementModule</code> in the <code>Modules\PersonsManagement</code> folder</li>
<li id="pragma-line-260">Create a new project <code>PersonsManagement.Services</code> in this folder</li>
<li id="pragma-line-261">Create the <code>PersonsManagementModule : IModule</code> class that notifies when it is alive</li>
<li id="pragma-line-262">Add the <code>PersonsManagement.Services</code> as a plugin in the AppBoot</li>
<li id="pragma-line-263">Create a new Schema (<code>Persons</code>) in the <code>AdventureWorks</code> database to host the new <code>Person</code> table
<ul id="pragma-line-264">
<li id="pragma-line-264">Create a new table <code>Person</code> in the <code>Persons</code> schema with the columns similar to the <code>Customer</code> table</li>
</ul>
</li>
<li id="pragma-line-265">Create the <code>Persons.DataModel</code> project in the <code>Modules\PersonsManagement</code> folder
<ul id="pragma-line-266">
<li id="pragma-line-266">Map the <code>Person</code> table to an entity</li>
</ul>
</li>
<li id="pragma-line-267">Create the <code>Persons.DbContext</code> project in the <code>Modules\PersonsManagement</code> folder
<ul id="pragma-line-268">
<li id="pragma-line-268">Implement the <code>IDbContextFactory</code> to provide the <code>DbContext</code> for the <code>Persons.DataModel</code></li>
</ul>
</li>
</ul>
<h3 id="add-a-new-person"><a id="pragma-line-270"></a>8.1. Add a new <code>Person</code></h3>
<blockquote id="pragma-line-272">
<p id="pragma-line-272">!Objective: See how existent Application Infrastructure capabilities are used by new features of new Modules</p>
</blockquote>
<h3 id="create-support-to-read-a-entity-from-the-console-1"><a id="pragma-line-274"></a>7.1.1. Create support to read a entity from the console</h3>
<p id="pragma-line-276">Use the following interfaces:</p>
<pre><code id="pragma-line-278">interface IEntityReader
{
    IEntityFieldsReader&lt;T&gt; BeginEntityRead&lt;T&gt;();
}

interface IEntityFieldsReader&lt;T&gt;
{
    IEnumerable&lt;string&gt; GetFields();
    void SetFieldValue(string value);
    T GetEntity();
}
</code></pre>
<p id="pragma-line-292">Read the data needed to create a <code>Person</code> entity</p>
<h3 id="create-a-service-that-adds-a-new-person-to-the-system"><a id="pragma-line-294"></a>8.1.2. Create a service that adds a new <code>Person</code> to the system</h3>
<p id="pragma-line-296">The above console command which reads the product category info should use this service to add the new read product category.</p>
<blockquote id="pragma-line-298">
<p id="pragma-line-298">!Observe: how the interceptors created in ex. 5 &amp; 6 are working when a new ProductCategory is added</p>
</blockquote>
<h3 id="import-persons-as-new-customers"><a id="pragma-line-300"></a>8.1.3. Import persons as new customers</h3>
<blockquote id="pragma-line-302">
<p id="pragma-line-302">!Objective: Use one service from a module into another module</p>
</blockquote>
<ul id="pragma-line-304">
<li id="pragma-line-304">Create a service in the <code>PersonsManagementModule</code> that gives all persons</li>
<li id="pragma-line-305">Create a service in the <code>SalesModule</code> that imports all persons as new customers
<ul id="pragma-line-306">
<li id="pragma-line-306">Decide upon a key / Modified data or other criteria to know which persons should be imported as new customers and were not yet imported</li>
</ul>
</li>
</ul>
</div>

<div id="plugin-contextmenu-container" class="selectNone"><ul id="plugin-contextmenu-99ef447c-a946-f210-fc20-99f87cff3879" class="plugin-contextmenu" data-plugin-is-contextmenu="true" style="display: none;"><li class="menuitem disabled" tabindex="1" role="menuitem" id="Copy" data-plugin-contextmenu-item-type="command" aria-disabled="true"><img class="icon" style="visibility: hidden;"><div class="main">Copy</div></li><li class="menuitem" tabindex="2" role="menuitem" id="Save" data-plugin-contextmenu-item-type="command"><img class="icon" style="visibility: hidden;"><div class="main">Save As HTML... </div></li><li class="menuitem" tabindex="3" role="menuitem" id="Print" data-plugin-contextmenu-item-type="command"><img class="icon" style="visibility: hidden;"><div class="main">Print HTML...</div></li></ul></div></body>